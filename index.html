<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <title>Whis â€“ The Unfair Advantage</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
  
  <script src="https://cdn.tailwindcss.com"></script>
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'], display: ['Inter', 'sans-serif'] },
          colors: { 
            page: '#050505', 
            glass: 'rgba(255, 255, 255, 0.03)',
          },
          animation: { 
            'intro-fade': 'introFade 3.5s ease-in-out forwards',
            'flash': 'lightningFlash 12s infinite random',
            'pulse-slow': 'pulse 6s cubic-bezier(0.4, 0, 0.6, 1) infinite',
          },
          keyframes: {
            introFade: {
                '0%': { opacity: '1', pointerEvents: 'auto' },
                '70%': { opacity: '1', pointerEvents: 'auto' },
                '100%': { opacity: '0', pointerEvents: 'none' }
            },
            lightningFlash: { 
                '0%, 92%, 100%': { opacity: '0' },
                '93%': { opacity: '0.15' },
                '94%': { opacity: '0' },
                '96%': { opacity: '0.3' }, 
                '97%': { opacity: '0' }
            }
          }
        }
      }
    }
  </script>
  
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <script src="https://accounts.google.com/gsi/client" async defer></script>
    
  <style>
    /* --- CORE THEME ENGINE --- */
    :root {
        --theme-primary: #3b82f6; /* Start Blue */
        --theme-glow: rgba(59, 130, 246, 0.5);
        animation: colorShift 30s infinite linear;
    }

    @keyframes colorShift {
        0% { --theme-primary: #3b82f6; --theme-glow: rgba(59, 130, 246, 0.5); }   /* Electric Blue */
        33% { --theme-primary: #a855f7; --theme-glow: rgba(168, 85, 247, 0.5); }  /* Royal Purple */
        66% { --theme-primary: #0d9488; --theme-glow: rgba(13, 148, 136, 0.5); }  /* Teal Lightning */
        100% { --theme-primary: #3b82f6; --theme-glow: rgba(59, 130, 246, 0.5); } /* Back to Blue */
    }

    body { 
        background-color: #020203; 
        color: white; 
        font-family: 'Inter', sans-serif; 
        -webkit-font-smoothing: antialiased; 
        overflow-x: hidden; 
    }

    /* --- UTILITIES --- */
    .dynamic-border { border-color: var(--theme-primary); transition: border-color 1s ease; }
    .dynamic-text { color: var(--theme-primary); transition: color 1s ease; }
    .dynamic-bg { background-color: var(--theme-primary); transition: background-color 1s ease; }
    .dynamic-shadow { box-shadow: 0 0 30px var(--theme-glow); transition: box-shadow 1s ease; }
    
    .glass-nav { 
        background: rgba(2, 2, 3, 0.7); 
        backdrop-filter: blur(20px); 
        border-bottom: 1px solid rgba(255,255,255,0.05); 
    }
    
    /* --- CINEMA CAROUSEL --- */
    .carousel-stage {
        position: relative;
        height: 50vh; /* Default height */
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        perspective: 1500px;
        transform-style: preserve-3d;
        z-index: 20;
    }
    @media (min-width: 768px) { .carousel-stage { height: 60vh; } }

    .carousel-item {
        position: absolute;
        width: 70%;
        aspect-ratio: 16/9; /* FORCE 16:9 NO CROPPING */
        transition: all 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
        border-radius: 16px;
        overflow: hidden;
        background: #000;
        box-shadow: 0 20px 50px rgba(0,0,0,0.8);
        border: 1px solid rgba(255,255,255,0.1);
    }
    
    /* Video sizing inside item */
    .carousel-item video {
        width: 100%;
        height: 100%;
        object-fit: contain; /* Ensures full video is seen, letterboxed if needed */
        background: black;
    }

    /* 3D States */
    .pos-center { 
        z-index: 30; 
        transform: translateX(0) scale(1); 
        opacity: 1; 
        box-shadow: 0 0 0 1px var(--theme-primary), 0 0 60px var(--theme-glow);
    }
    .pos-left { 
        z-index: 10; 
        transform: translateX(-50%) scale(0.8) translateZ(-200px) rotateY(15deg); 
        opacity: 0.3; 
        filter: blur(5px) grayscale(100%);
        pointer-events: none;
    }
    .pos-right { 
        z-index: 10; 
        transform: translateX(50%) scale(0.8) translateZ(-200px) rotateY(-15deg); 
        opacity: 0.3; 
        filter: blur(5px) grayscale(100%);
        pointer-events: none;
    }

    /* CINEMATIC HOVER STATE (The "Ultra Pro Max" Feature) */
    .carousel-stage:has(.pos-center:hover) .pos-left,
    .carousel-stage:has(.pos-center:hover) .pos-right {
        opacity: 0;
        transition: opacity 0.3s;
    }

    .pos-center.is-expanding {
        position: fixed;
        top: 50%;
        left: 50%;
        width: 90vw !important;
        height: 85vh !important;
        transform: translate(-50%, -50%) !important;
        z-index: 9999;
        border-radius: 24px;
        box-shadow: 0 0 0 100vh rgba(0,0,0,0.95), 0 0 50px var(--theme-primary);
        aspect-ratio: unset;
        object-fit: contain;
    }

    /* --- UI ELEMENTS --- */
    .glass-card { 
        background: linear-gradient(180deg, rgba(20, 20, 25, 0.6) 0%, rgba(5, 5, 5, 0.8) 100%); 
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.08); 
    }

    .btn-shine { 
        position: relative;
        overflow: hidden;
        background: linear-gradient(90deg, #1e1e1e, #2a2a2a, #1e1e1e);
        border: 1px solid rgba(255,255,255,0.1);
    }
    .btn-shine::after {
        content: '';
        position: absolute;
        top: 0; left: -100%;
        width: 50%; height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transform: skewX(-20deg);
        animation: shimmer 3s infinite;
    }
    
    @keyframes shimmer { 0% { left: -100%; } 20% { left: 200%; } 100% { left: 200%; } }
    
    /* Scrollbar */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #000; }
    ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--theme-primary); }
  </style>
</head>
<body class="selection:bg-white/20 selection:text-white">

  <div id="intro-layer" class="fixed inset-0 z-[10000] bg-black flex items-center justify-center animate-intro-fade">
      <div class="text-center px-6">
          <h1 class="text-3xl md:text-5xl font-light tracking-[0.2em] text-white uppercase mb-4">Witness Perfection</h1>
          <div class="h-[1px] w-0 bg-white mx-auto animate-[widthGrow_1s_ease-out_forwards]"></div>
      </div>
  </div>
  <style> @keyframes widthGrow { to { width: 100%; } } </style>


  <div class="fixed inset-0 z-0 pointer-events-none">
    <div class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-[0.05] mix-blend-overlay"></div>
    <div class="absolute inset-0 bg-slate-300 mix-blend-overlay opacity-0 animate-flash"></div>
    <div class="absolute top-[-20%] left-1/2 -translate-x-1/2 w-[800px] h-[800px] rounded-full mix-blend-screen blur-[120px] opacity-20 dynamic-bg animate-pulse-slow"></div>
  </div>


  <nav class="fixed top-0 w-full z-50 glass-nav h-[70px] flex items-center justify-center transition-all duration-300">
    <div class="w-full max-w-7xl px-6 flex items-center justify-between">
      <a href="/" class="flex items-center gap-3 group">
        <div class="relative w-10 h-10 flex items-center justify-center">
            <div class="absolute inset-0 rounded-full border border-white/20 dynamic-border shadow-[0_0_15px_rgba(255,255,255,0.1)]"></div>
            <i class="fa-solid fa-bolt dynamic-text text-lg drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]"></i>
        </div>
        <span class="text-lg font-bold tracking-tight">Whis<span class="opacity-50">.ai</span></span>
      </a>
      
      <div class="hidden md:flex items-center bg-white/5 p-1 rounded-full border border-white/5 backdrop-blur-md">
        <a href="#features" class="px-5 py-2 text-xs font-medium text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition">The Method</a>
        <a href="#security" class="px-5 py-2 text-xs font-medium text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition">Invisibility</a>
        <a href="/pricing" class="px-5 py-2 text-xs font-medium text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition">Access</a>
      </div>

      <div class="flex items-center gap-4">
          <button onclick="openLoginModal()" id="signInBtn" class="text-xs font-medium text-slate-400 hover:text-white transition hidden md:block">Log In</button>
          
          <button onclick="openDownloadModal()" class="dynamic-bg text-white px-5 py-2 rounded-full text-xs font-bold hover:brightness-110 transition shadow-[0_0_20px_rgba(255,255,255,0.2)]">
            Get Advantage
          </button>
          
          <button onclick="openProfileModal()" id="userProfileTrigger" class="hidden items-center gap-2 bg-white/5 pr-3 pl-1 py-1 rounded-full border border-white/10 hover:border-white/20 transition">
            <img id="navUserAvatar" src="" class="w-8 h-8 rounded-full bg-slate-800 object-cover" />
            <span id="navPlanBadge" class="text-[9px] font-bold dynamic-text uppercase tracking-wide">PRO</span>
          </button>
      </div>
    </div>
  </nav>


  <section class="relative pt-32 pb-12 overflow-hidden flex flex-col items-center min-h-screen">
    
    <div class="relative z-10 text-center max-w-5xl px-6 mb-8 flex flex-col items-center">
      <div class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/5 border border-white/10 text-[10px] font-bold uppercase tracking-widest mb-6 dynamic-text">
        <span class="w-1.5 h-1.5 rounded-full dynamic-bg animate-pulse"></span> System Status: Undetected
      </div>
      
      <h1 class="text-5xl md:text-8xl font-medium tracking-tighter leading-[0.9] mb-8 text-transparent bg-clip-text bg-gradient-to-b from-white to-slate-500">
        Don't Just Prepare.<br>
        <span class="dynamic-text drop-shadow-[0_0_30px_rgba(255,255,255,0.1)]">Have The Answers.</span>
      </h1>
      
      <p class="text-lg text-slate-400 max-w-xl mx-auto mb-10 font-light">
        The interview is a game. <strong class="text-white">Cheating is just a strategy.</strong><br>
        Invisible. Real-time. The unfair advantage you deserve.
      </p>

      <button id="smartDownloadBtn" class="btn-shine px-8 py-3.5 rounded-lg text-sm font-medium text-white transition hover:scale-[1.02] active:scale-[0.98] shadow-2xl flex items-center gap-3">
        <i id="osIcon" class="fa-brands fa-apple text-lg"></i> <span id="osText">Download Client</span>
      </button>
    </div>

    <div class="w-full max-w-[1800px] mx-auto relative z-20 mt-8 mb-20 group/stage">
        <div class="carousel-stage" id="carouselStage"></div>
        
        <div class="absolute bottom-[-60px] left-1/2 -translate-x-1/2 flex flex-col items-center gap-4">
            <div id="activeFeatureLabel" class="text-xs font-bold dynamic-text uppercase tracking-[0.3em] bg-black/50 border border-white/10 px-6 py-2 rounded-full backdrop-blur-md">
                LOADING SYSTEM...
            </div>
            <div class="flex gap-2">
                <div class="w-12 h-1 bg-white/10 rounded-full overflow-hidden">
                    <div id="prog-0" class="h-full dynamic-bg w-0"></div>
                </div>
                <div class="w-12 h-1 bg-white/10 rounded-full overflow-hidden">
                    <div id="prog-1" class="h-full dynamic-bg w-0"></div>
                </div>
                <div class="w-12 h-1 bg-white/10 rounded-full overflow-hidden">
                    <div id="prog-2" class="h-full dynamic-bg w-0"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="w-full max-w-6xl px-6 text-center mt-24 opacity-40 hover:opacity-100 transition duration-700">
        <p class="text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em] mb-8">Used at Top Tier Firms</p>
        <div class="flex flex-wrap justify-center gap-12 grayscale hover:grayscale-0 transition duration-500">
            <i class="fa-brands fa-google text-3xl"></i>
            <i class="fa-brands fa-amazon text-3xl"></i>
            <i class="fa-brands fa-meta text-3xl"></i>
            <i class="fa-brands fa-microsoft text-3xl"></i>
            <i class="fa-brands fa-stripe text-3xl"></i>
        </div>
    </div>
  </section>


  <section id="features" class="py-24 relative border-t border-white/5 bg-black/50 backdrop-blur-sm">
      <div class="max-w-7xl mx-auto px-6">
          <h2 class="text-4xl font-medium text-white mb-16 tracking-tight text-center">God Mode Enabled.</h2>
          
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
              <div class="glass-card rounded-2xl p-8 hover:bg-white/5 transition duration-500 group">
                  <div class="w-12 h-12 rounded-lg bg-white/5 flex items-center justify-center border border-white/10 mb-6 dynamic-text group-hover:scale-110 transition">
                      <i class="fa-solid fa-ghost text-xl"></i>
                  </div>
                  <h3 class="text-lg font-bold text-white mb-2">Ghost Protocol</h3>
                  <p class="text-sm text-slate-400">Undetectable by Zoom, Teams, or Meet. It renders on a secure overlay layer that screen sharing cannot see.</p>
              </div>

              <div class="glass-card rounded-2xl p-8 hover:bg-white/5 transition duration-500 group">
                  <div class="w-12 h-12 rounded-lg bg-white/5 flex items-center justify-center border border-white/10 mb-6 dynamic-text group-hover:scale-110 transition">
                      <i class="fa-solid fa-brain text-xl"></i>
                  </div>
                  <h3 class="text-lg font-bold text-white mb-2">Context Awareness</h3>
                  <p class="text-sm text-slate-400">Whis listens to audio and reads the screen simultaneously to understand complex system design questions.</p>
              </div>

              <div class="glass-card rounded-2xl p-8 hover:bg-white/5 transition duration-500 group">
                  <div class="w-12 h-12 rounded-lg bg-white/5 flex items-center justify-center border border-white/10 mb-6 dynamic-text group-hover:scale-110 transition">
                      <i class="fa-solid fa-code text-xl"></i>
                  </div>
                  <h3 class="text-lg font-bold text-white mb-2">Auto-Injection</h3>
                  <p class="text-sm text-slate-400">Don't type. Whis can inject the code directly into your IDE at a human-like typing speed.</p>
              </div>
          </div>
      </div>
  </section>

  <footer class="border-t border-white/5 py-12 bg-black text-center relative z-10">
      <div class="max-w-7xl mx-auto px-6">
          <h3 class="text-white font-medium text-lg mb-6">Secure your future today.</h3>
          <button onclick="openDownloadModal()" class="px-8 py-2 rounded-full border border-white/20 hover:bg-white hover:text-black transition text-xs font-bold uppercase tracking-widest mb-10">Get Whis</button>
          <div class="text-xs text-slate-600">&copy; 2025 Whis AI. All systems operational.</div>
      </div>
  </footer>

  <div id="loginModal" class="fixed inset-0 bg-black/90 backdrop-blur-xl z-[100] hidden items-center justify-center p-4">
      <div class="glass-card rounded-2xl p-8 max-w-sm w-full text-center border border-white/10 relative">
        <button onclick="closeLoginModal()" class="absolute top-4 right-4 text-slate-500 hover:text-white"><i class="fa-solid fa-times"></i></button>
        <h3 class="text-xl font-bold text-white mb-2">Identity Verification</h3>
        <p class="text-xs text-slate-500 mb-6">Login to manage your stealth plan.</p>
        <div id="googleBtnContainer" class="flex justify-center h-[44px]"></div>
      </div>
  </div>

  <div id="downloadModal" class="fixed inset-0 bg-black/90 backdrop-blur-xl z-[100] hidden items-center justify-center p-4">
    <div class="glass-card rounded-2xl p-8 max-w-md w-full border border-white/10 relative">
        <button onclick="closeDownloadModal()" class="absolute top-4 right-4 text-slate-500 hover:text-white"><i class="fa-solid fa-times"></i></button>
        <h3 class="text-xl font-bold text-white mb-6">Select Architecture</h3>
        <div class="space-y-3">
            <a href="#" class="flex items-center justify-between p-4 bg-white/5 rounded-lg hover:bg-white/10 border border-white/5 transition group">
                <span class="flex items-center gap-3"><i class="fa-brands fa-apple text-xl"></i> macOS (Silicon/Intel)</span>
                <i class="fa-solid fa-arrow-right text-slate-500 group-hover:text-white"></i>
            </a>
            <a href="#" class="flex items-center justify-between p-4 bg-white/5 rounded-lg hover:bg-white/10 border border-white/5 transition group">
                <span class="flex items-center gap-3"><i class="fa-brands fa-windows text-xl"></i> Windows 11/10</span>
                <i class="fa-solid fa-arrow-right text-slate-500 group-hover:text-white"></i>
            </a>
        </div>
    </div>
  </div>
  
  <div id="profileModal" class="fixed inset-0 bg-black/90 backdrop-blur-xl z-[100] hidden items-center justify-center p-4">
    <div class="glass-card rounded-2xl p-0 max-w-sm w-full border border-white/10 overflow-hidden relative">
        <div class="p-4 bg-white/5 border-b border-white/5 flex justify-between items-center">
            <span class="text-xs font-bold tracking-widest text-slate-500 uppercase">User Profile</span>
            <button onclick="closeProfileModal()" class="text-slate-500 hover:text-white"><i class="fa-solid fa-times"></i></button>
        </div>
        <div class="p-6 text-center">
            <img id="modalUserAvatar" class="w-16 h-16 rounded-full mx-auto mb-4 border-2 dynamic-border p-1" />
            <h3 id="modalUserName" class="text-lg font-bold text-white">User</h3>
            <div class="mt-6 bg-white/5 rounded-lg p-4 text-left">
                <p class="text-[10px] text-slate-500 uppercase tracking-widest mb-1">Plan Status</p>
                <div class="flex justify-between items-center">
                    <span id="modalPlanName" class="text-lg font-bold text-white">Checking...</span>
                    <span id="modalPlanStatus" class="px-2 py-0.5 rounded text-[10px] font-bold bg-white/10 text-white">...</span>
                </div>
            </div>
            <button onclick="logout()" class="w-full mt-6 py-3 rounded-lg border border-red-500/20 text-red-400 hover:bg-red-500/10 transition text-xs font-bold uppercase">Sign Out</button>
        </div>
    </div>
  </div>

  <script>
    // --- APP LOGIC ---
    const BACKEND_URL="https://whis-backend.onrender.com";
    const GOOGLE_CLIENT_ID="91011354786-0giqfdd547vj6ojkk26qdj4jucl5v07p.apps.googleusercontent.com";
    
    // UI Elements
    const loginModal = document.getElementById('loginModal');
    const downloadModal = document.getElementById('downloadModal');
    const profileModal = document.getElementById('profileModal');
    let currentUser = null;

    // --- CAROUSEL CONFIGURATION ---
    const videos = [
        { src: 'visual.mp4', label: 'PHASE 1: VISUAL RECOGNITION' },
        { src: 'text.mp4', label: 'PHASE 2: CODE SYNTHESIS' },
        { src: 'audio.mp4', label: 'PHASE 3: AUDIO INGESTION' }
    ];
    let activeIndex = 0;
    let carouselItems = [];
    let isHovering = false; // To pause rotation on hover

    document.addEventListener("DOMContentLoaded", () => {
        initCarousel();
        detectOS();
        checkUser();
        
        // Remove intro layer from DOM after animation to prevent click blocking
        setTimeout(() => {
            const intro = document.getElementById('intro-layer');
            intro.style.display = 'none';
        }, 3600);
    });

    function initCarousel() {
        const stage = document.getElementById('carouselStage');
        stage.innerHTML = '';
        
        videos.forEach((v, i) => {
            // Container
            const div = document.createElement('div');
            div.className = 'carousel-item';
            div.id = `item-${i}`;
            
            // Video Element
            const vid = document.createElement('video');
            vid.src = v.src;
            vid.muted = true; 
            vid.playsInline = true;
            vid.preload = "auto";
            
            // Interaction: Expansion
            div.addEventListener('mouseenter', () => {
                if(i === activeIndex) {
                    isHovering = true;
                    div.classList.add('is-expanding');
                    vid.muted = false; // Unmute for immersive experience
                }
            });
            div.addEventListener('mouseleave', () => {
                isHovering = false;
                div.classList.remove('is-expanding');
                vid.muted = true;
            });

            // Logic: Auto-Play Next
            vid.onended = () => {
                if(!isHovering) {
                   manualSet((activeIndex + 1) % videos.length);
                } else {
                   vid.play(); // Loop if hovering
                }
            };

            div.appendChild(vid);
            stage.appendChild(div);
            carouselItems.push({ div, vid });
        });
        
        updateCarouselPositions();
    }

    function updateCarouselPositions() {
        const total = videos.length;
        const prevIndex = (activeIndex - 1 + total) % total;
        const nextIndex = (activeIndex + 1) % total;

        carouselItems.forEach((item, i) => {
            // Clean classes
            item.div.className = 'carousel-item transition-all duration-700 ease-in-out';
            
            // Assign Position
            if (i === activeIndex) {
                item.div.classList.add('pos-center');
                item.vid.play().catch(e => console.log("Autoplay blocked"));
                item.vid.style.opacity = "1";
            } else if (i === prevIndex) {
                item.div.classList.add('pos-left');
                item.vid.pause();
                item.vid.currentTime = 0;
                item.vid.style.opacity = "0.5";
            } else if (i === nextIndex) {
                item.div.classList.add('pos-right');
                item.vid.pause();
                item.vid.currentTime = 0;
                item.vid.style.opacity = "0.5";
            } else {
                // Hide others behind
                item.div.style.opacity = "0"; 
                item.div.style.zIndex = "0";
                item.div.style.transform = "scale(0.5)";
            }
        });

        // Update Text & Bars
        document.getElementById('activeFeatureLabel').innerText = videos[activeIndex].label;
        [0,1,2].forEach(idx => {
            const bar = document.getElementById(`prog-${idx}`);
            bar.style.width = (idx === activeIndex) ? '100%' : '0%';
            bar.style.transition = (idx === activeIndex) ? 'width 4s linear' : 'width 0.3s'; // Rough sync with video length
        });
    }

    function manualSet(idx) {
        activeIndex = idx;
        updateCarouselPositions();
    }

    // --- UTILITIES ---
    function detectOS(){
        const p = navigator.platform.toLowerCase(); 
        const ua = navigator.userAgent.toLowerCase();
        const btn = document.getElementById('smartDownloadBtn');
        const icon = document.getElementById('osIcon'); 
        const txt = document.getElementById('osText');
        
        if (p.includes('win')||ua.includes('win')) { 
            txt.innerText = "Download for Windows"; 
            icon.className = "fa-brands fa-windows text-lg"; 
            btn.onclick = () => window.location.href="https://github.com/syedwaseemfahad/whis-releases/releases/download/v.1.0.windows/Whis.Setup.1.0.1.exe";
        } else {
            txt.innerText = "Download for macOS"; 
            icon.className = "fa-brands fa-apple text-lg"; 
            btn.onclick = () => window.location.href="https://github.com/syedwaseemfahad/whis-releases/releases/download/v1.0.0/Whis-1.0.0-arm64.dmg";
        }
    }

    // --- AUTH (Minified for space) ---
    function checkUser(){ const s=localStorage.getItem('whisUser'); if(s){ try{ currentUser=JSON.parse(s); updateNavUI(currentUser); }catch(e){localStorage.removeItem('whisUser');} } }
    function openLoginModal(){loginModal.classList.remove('hidden');loginModal.classList.add('flex');if(window.google){google.accounts.id.initialize({client_id:GOOGLE_CLIENT_ID,callback:hGoogle});google.accounts.id.renderButton(document.getElementById("googleBtnContainer"),{theme:"filled_black",size:"large",shape:"pill"});}}
    function closeLoginModal(){loginModal.classList.add('hidden');loginModal.classList.remove('flex');}
    function openDownloadModal(){downloadModal.classList.remove('hidden');downloadModal.classList.add('flex');}
    function closeDownloadModal(){downloadModal.classList.add('hidden');downloadModal.classList.remove('flex');}
    function openProfileModal(){if(currentUser){document.getElementById('modalUserAvatar').src=currentUser.avatarUrl;document.getElementById('modalUserName').innerText=currentUser.name;fetchFullUserData(currentUser.googleId);}profileModal.classList.remove('hidden');profileModal.classList.add('flex');}
    function closeProfileModal(){profileModal.classList.add('hidden');profileModal.classList.remove('flex');}
    function logout(){localStorage.removeItem('whisUser');location.reload();}
    function updateNavUI(u){document.getElementById('signInBtn').style.display='none';document.getElementById('userProfileTrigger').classList.remove('hidden');document.getElementById('userProfileTrigger').classList.add('flex');document.getElementById('navUserAvatar').src=u.avatarUrl;}
    async function hGoogle(res){try{const r=await fetch(`${BACKEND_URL}/api/auth/google`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:res.credential})});if(r.ok){const d=await r.json();if(d.success){localStorage.setItem('whisUser',JSON.stringify(d.user));currentUser=d.user;updateNavUI(currentUser);closeLoginModal();fetchFullUserData(currentUser.googleId);}}}catch(e){}}
    async function fetchFullUserData(gid){try{const r=await fetch(`${BACKEND_URL}/api/user/status`,{headers:{'x-google-id':gid}});const d=await r.json();const b=document.getElementById('navPlanBadge');const mb=document.getElementById('modalPlanStatus');if(d.active){b.textContent=(d.tier==='pro_plus'?'ELITE':'PRO');mb.textContent="ACTIVE";document.getElementById('modalPlanName').textContent=d.tier==='pro_plus'?'Elite Plan':'Pro Plan';}else{b.textContent="FREE";mb.textContent="INACTIVE";document.getElementById('modalPlanName').textContent='Free Tier';}}catch(e){}}
  </script>
</body>
</html>
