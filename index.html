<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8" />
    <title>Whis â€“ Secure Your Future</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: { sans: ['SF Pro Display', 'Inter', '-apple-system', 'BlinkMacSystemFont', 'sans-serif'] },
            colors: { 
              ultra: '#007AFF', /* Apple/Electric Blue */
            },
            animation: { 
              'float': 'float 6s ease-in-out infinite',
              'pulse-glow': 'pulseGlow 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            },
            keyframes: {
              float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-10px)' } },
              pulseGlow: { '0%, 100%': { opacity: 1, boxShadow: '0 0 20px rgba(0, 122, 255, 0.5)' }, '50%': { opacity: .8, boxShadow: '0 0 40px rgba(0, 122, 255, 0.8)' } }
            }
          }
        }
      }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <script src="https://accounts.google.com/gsi/client" async defer></script>
      
    <style>
      /* --- ULTRA PRO MAX RESET --- */
      body { background-color: #000000; color: white; font-family: 'Inter', sans-serif; overflow-x: hidden; -webkit-font-smoothing: antialiased; }
      
      /* --- OPTIMIZED CAROUSEL ENGINE --- */
      .carousel-stage {
          position: relative;
          height: 400px; /* Mobile height */
          width: 100%;
          display: flex;
          justify-content: center;
          align-items: center;
          perspective: 1200px; /* Reduced perspective for sharper text */
          transform-style: preserve-3d;
      }
      @media (min-width: 768px) { .carousel-stage { height: 700px; } }

      .carousel-item {
          position: absolute;
          width: 90%; 
          max-width: 1100px;
          aspect-ratio: 16/10;
          transition: all 0.7s cubic-bezier(0.16, 1, 0.3, 1); /* Apple-style spring physics */
          border-radius: 20px;
          overflow: hidden;
          background: #050505;
          /* GPU Force */
          will-change: transform, opacity;
          transform: translate3d(0,0,0);
      }
        
      /* Active Item: Clear, Bright, Front */
      .pos-center { 
          z-index: 30; 
          transform: translate3d(0, 0, 0) scale(1); 
          opacity: 1; 
          border: 1px solid rgba(255,255,255,0.15);
          box-shadow: 0 40px 100px -20px rgba(0,0,0,1), 0 0 0 1px rgba(0,0,0,1);
      }
      
      /* Active Item Glow Border */
      .pos-center::after {
          content: ''; position: absolute; inset: 0; pointer-events: none;
          border-radius: 20px;
          border: 2px solid transparent;
          background: linear-gradient(135deg, rgba(255,255,255,0.1), transparent 40%) border-box;
          -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
          -webkit-mask-composite: xor;
          mask-composite: exclude;
      }

      /* Inactive Items: Glassy, Blurred, Receded (NO VIDEO TO SAVE CPU) */
      .pos-left { 
          z-index: 10; 
          transform: translate3d(-60%, 0, -200px) rotateY(15deg); 
          opacity: 0.4; 
          filter: blur(2px) brightness(0.5);
          pointer-events: none; 
          border: 1px solid rgba(255,255,255,0.05);
      } 
      .pos-right { 
          z-index: 10; 
          transform: translate3d(60%, 0, -200px) rotateY(-15deg); 
          opacity: 0.4; 
          filter: blur(2px) brightness(0.5);
          pointer-events: none; 
          border: 1px solid rgba(255,255,255,0.05);
      }

      /* --- HIGH VISIBILITY COMPONENTS --- */
      .btn-ultra {
          background: linear-gradient(180deg, #007AFF 0%, #0062CC 100%);
          color: white !important;
          font-weight: 700;
          border: 1px solid rgba(255,255,255,0.2);
          box-shadow: 0 0 25px rgba(0, 122, 255, 0.4), inset 0 1px 1px rgba(255,255,255,0.3);
          text-shadow: 0 1px 2px rgba(0,0,0,0.3);
          transition: transform 0.2s;
      }
      .btn-ultra:hover { transform: scale(1.02); box-shadow: 0 0 40px rgba(0, 122, 255, 0.6), inset 0 1px 1px rgba(255,255,255,0.4); }
      .btn-ultra:active { transform: scale(0.98); }

      .btn-ghost {
          background: rgba(255,255,255,0.08);
          border: 1px solid rgba(255,255,255,0.1);
          color: white;
          font-weight: 600;
          transition: all 0.3s;
      }
      .btn-ghost:hover { background: rgba(255,255,255,0.15); border-color: white; }

      .glass-panel {
          background: rgba(10, 10, 10, 0.7);
          backdrop-filter: blur(20px);
          -webkit-backdrop-filter: blur(20px);
          border: 1px solid rgba(255,255,255,0.08);
          box-shadow: 0 20px 40px rgba(0,0,0,0.6);
      }

      .text-glow { text-shadow: 0 0 30px rgba(255,255,255,0.3); }
      .text-blue-glow { text-shadow: 0 0 20px rgba(0, 122, 255, 0.8); }
      
      /* Hide scrollbar */
      ::-webkit-scrollbar { width: 8px; }
      ::-webkit-scrollbar-track { background: #000; }
      ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
      ::-webkit-scrollbar-thumb:hover { background: #555; }
    </style>
</head>
<body>

    <div class="fixed inset-0 z-0 pointer-events-none">
        <div class="absolute top-[-20%] left-1/2 -translate-x-1/2 w-[800px] h-[800px] bg-[#007AFF] opacity-[0.12] blur-[150px] rounded-full"></div>
    </div>

    <nav class="fixed top-0 w-full z-50 h-[80px] flex items-center justify-center transition-all duration-300 glass-panel border-b-0">
      <div class="w-full max-w-7xl px-6 flex items-center justify-between">
        <a href="/" class="flex items-center gap-3 group">
          <div class="w-10 h-10 rounded-xl bg-white flex items-center justify-center shadow-[0_0_15px_rgba(255,255,255,0.3)]">
            <span class="text-sm font-black text-black tracking-tighter">WH</span>
          </div>
          <span class="text-lg font-bold text-white tracking-tight group-hover:text-blue-400 transition">whis.ai</span>
        </a>
          
        <div class="hidden md:flex items-center gap-1 bg-black/40 p-1.5 rounded-full border border-white/10 backdrop-blur-md">
          <a href="#features" class="px-6 py-2 text-sm font-medium text-slate-400 hover:text-white hover:bg-white/10 rounded-full transition">How It Works</a>
          <a href="#security" class="px-6 py-2 text-sm font-medium text-slate-400 hover:text-white hover:bg-white/10 rounded-full transition">Safety</a>
          <a href="/pricing" class="px-6 py-2 text-sm font-medium text-slate-400 hover:text-white hover:bg-white/10 rounded-full transition">Plans</a>
        </div>

        <div class="flex items-center gap-4">
            <button onclick="openLoginModal()" id="signInBtn" class="text-sm font-semibold text-slate-300 hover:text-white transition hidden lg:block">Sign In</button>
            <button onclick="openDownloadModal()" class="px-6 py-2.5 btn-ultra rounded-full text-sm tracking-wide">Get Whis</button>
            
            <button onclick="openProfileModal()" id="userProfileTrigger" class="hidden items-center gap-3 bg-white/5 pr-4 pl-2 py-1.5 rounded-full border border-white/10 hover:border-white/30 transition group">
              <img id="navUserAvatar" src="" class="w-8 h-8 rounded-full bg-slate-800 object-cover" />
              <span id="navPlanBadge" class="text-[10px] font-bold text-blue-400 uppercase tracking-widest">ELITE</span>
            </button>
        </div>
      </div>
    </nav>

    <section class="relative pt-40 pb-20 md:pt-56 md:pb-32 overflow-hidden flex flex-col items-center">
        
      <div class="relative z-10 text-center max-w-5xl px-6 mb-16 animate-float">
        <div class="inline-flex items-center gap-3 px-5 py-2 rounded-full bg-white/5 border border-white/10 text-slate-300 text-[10px] font-bold uppercase tracking-[0.2em] mb-10 backdrop-blur-sm">
          <span class="w-2 h-2 rounded-full bg-[#007AFF] shadow-[0_0_10px_#007AFF] animate-pulse"></span> 
          System Operational
        </div>
        
        <h1 class="text-5xl md:text-8xl font-black tracking-tight leading-[1.05] mb-8 text-white text-glow">
          Don't Just Prepare.<br>
          <span class="text-transparent bg-clip-text bg-gradient-to-b from-blue-400 to-blue-600 text-blue-glow">Have The Answers.</span>
        </h1>
        
        <p class="text-lg md:text-2xl text-slate-400 max-w-2xl mx-auto mb-12 font-medium leading-relaxed">
          The ultimate stealth assistant for technical interviews. <br>
          <span class="text-white">Invisible. Undetectable. Real-time.</span>
        </p>
        
        <div class="flex flex-col md:flex-row items-center justify-center gap-5">
          <button id="smartDownloadBtn" class="w-full md:w-auto btn-ultra rounded-2xl px-12 py-5 text-xl tracking-tight flex items-center justify-center gap-3">
            <i id="osIcon" class="fa-brands fa-apple text-2xl"></i> 
            <span id="osText">Download for macOS</span>
          </button>
          <a href="#features" class="w-full md:w-auto btn-ghost rounded-2xl px-10 py-5 text-lg flex items-center justify-center">
            See How It Works
          </a>
        </div>
      </div>

      <div class="w-full max-w-[1600px] mx-auto px-4 relative z-20">
          <div class="carousel-stage" id="carouselStage"></div>
          
          <div class="flex flex-col items-center mt-12 gap-6">
              <div id="activeFeatureLabel" class="text-sm font-bold text-blue-400 uppercase tracking-[0.3em]">
                  Initializing...
              </div>
              
              <div class="flex justify-center gap-4">
                  <button onclick="manualSet(0)" id="ind-0" class="w-12 h-1.5 rounded-full bg-white transition-all"></button>
                  <button onclick="manualSet(1)" id="ind-1" class="w-2 h-1.5 rounded-full bg-white/20 hover:bg-white transition-all"></button>
                  <button onclick="manualSet(2)" id="ind-2" class="w-2 h-1.5 rounded-full bg-white/20 hover:bg-white transition-all"></button>
              </div>
          </div>
      </div>

      <div class="w-full max-w-5xl px-6 text-center mt-32">
          <p class="text-xs font-bold text-slate-600 uppercase tracking-[0.3em] mb-10">Used by engineers at</p>
          <div class="flex flex-wrap justify-center gap-10 md:gap-20 opacity-40 grayscale hover:grayscale-0 hover:opacity-100 transition duration-500">
              <i class="fa-brands fa-google text-3xl md:text-4xl hover:text-white transition cursor-default"></i>
              <i class="fa-brands fa-amazon text-3xl md:text-4xl hover:text-white transition cursor-default"></i>
              <i class="fa-brands fa-meta text-3xl md:text-4xl hover:text-white transition cursor-default"></i>
              <i class="fa-brands fa-microsoft text-3xl md:text-4xl hover:text-white transition cursor-default"></i>
              <i class="fa-brands fa-uber text-3xl md:text-4xl hover:text-white transition cursor-default"></i>
          </div>
      </div>
    </section>

    <section id="features" class="py-32 bg-[#050505] relative">
        <div class="max-w-7xl mx-auto px-6">
            <div class="text-center mb-24">
                <h2 class="text-4xl md:text-6xl font-bold text-white mb-6">The Unfair Advantage.</h2>
                <p class="text-slate-400 text-xl">Technology designed to make you look like a genius.</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="glass-panel rounded-3xl p-10 hover:bg-white/5 transition duration-500 group">
                    <div class="w-14 h-14 rounded-2xl bg-blue-600 flex items-center justify-center text-white text-2xl mb-8 shadow-lg shadow-blue-900/50 group-hover:scale-110 transition"><i class="fa-solid fa-ghost"></i></div>
                    <h3 class="text-xl font-bold text-white mb-3">Totally Invisible</h3>
                    <p class="text-slate-400 leading-relaxed">Hidden from screen sharing. Hidden from task managers. It runs as a system kernel process that interview platforms cannot detect.</p>
                </div>
                <div class="glass-panel rounded-3xl p-10 hover:bg-white/5 transition duration-500 group">
                    <div class="w-14 h-14 rounded-2xl bg-white/10 flex items-center justify-center text-white text-2xl mb-8 border border-white/10 group-hover:scale-110 transition"><i class="fa-solid fa-bolt"></i></div>
                    <h3 class="text-xl font-bold text-white mb-3">Instant Answers</h3>
                    <p class="text-slate-400 leading-relaxed">Whis listens to the audio stream. It generates the optimal code solution (Python, Java, C++) before the interviewer finishes their sentence.</p>
                </div>
                <div class="glass-panel rounded-3xl p-10 hover:bg-white/5 transition duration-500 group">
                    <div class="w-14 h-14 rounded-2xl bg-white/10 flex items-center justify-center text-white text-2xl mb-8 border border-white/10 group-hover:scale-110 transition"><i class="fa-solid fa-eye"></i></div>
                    <h3 class="text-xl font-bold text-white mb-3">Screen Reading</h3>
                    <p class="text-slate-400 leading-relaxed">System design diagram? LeetCode problem text? Whis reads your screen using OCR and solves visuals instantly.</p>
                </div>
            </div>
        </div>
    </section>

    <footer class="border-t border-white/10 py-24 bg-black">
        <div class="max-w-4xl mx-auto px-6 text-center">
            <h3 class="text-white font-bold text-3xl mb-10">Secure Your Offer Today.</h3>
            <button onclick="openDownloadModal()" class="mb-16 px-12 py-5 btn-ultra rounded-full text-lg tracking-wide shadow-[0_0_50px_rgba(0,122,255,0.4)]">Get The Advantage</button>
            <div class="flex justify-center gap-10 text-sm font-medium text-slate-500">
                <a href="#" class="hover:text-white transition">Privacy</a>
                <a href="#" class="hover:text-white transition">Terms</a>
                <a href="#" class="hover:text-white transition">Contact</a>
            </div>
        </div>
    </footer>

    <div id="downloadModal" class="fixed inset-0 bg-black/90 backdrop-blur-2xl z-[100] hidden items-center justify-center p-4">
        <div class="glass-panel rounded-3xl p-10 max-w-md w-full relative border border-white/20 shadow-2xl">
            <button onclick="closeDownloadModal()" class="absolute top-6 right-6 text-slate-500 hover:text-white text-xl"><i class="fa-solid fa-times"></i></button>
            <h2 class="text-3xl font-black text-white mb-2">Download Whis</h2>
            <p class="text-slate-400 mb-8">Select your platform to begin.</p>
            <div class="space-y-4">
                <a href="#" class="flex items-center justify-between px-6 py-5 bg-white/5 border border-white/10 rounded-2xl hover:bg-blue-600 hover:border-blue-500 transition group">
                    <span class="text-lg font-bold text-white flex items-center gap-3"><i class="fa-brands fa-apple text-2xl"></i> macOS</span>
                    <i class="fa-solid fa-arrow-right text-white/50 group-hover:text-white"></i>
                </a>
                <a href="#" class="flex items-center justify-between px-6 py-5 bg-white/5 border border-white/10 rounded-2xl hover:bg-blue-600 hover:border-blue-500 transition group">
                    <span class="text-lg font-bold text-white flex items-center gap-3"><i class="fa-brands fa-windows text-2xl"></i> Windows</span>
                    <i class="fa-solid fa-arrow-right text-white/50 group-hover:text-white"></i>
                </a>
            </div>
        </div>
    </div>
    
    <div id="loginModal" class="fixed inset-0 bg-black/90 backdrop-blur-2xl z-[100] hidden items-center justify-center p-4">
        <div class="glass-panel rounded-3xl p-10 max-w-sm w-full text-center border border-white/20 shadow-2xl relative">
            <button onclick="closeLoginModal()" class="absolute top-6 right-6 text-slate-500 hover:text-white"><i class="fa-solid fa-times"></i></button>
            <h3 class="text-2xl font-bold text-white mb-2">Welcome Back</h3>
            <p class="text-slate-400 mb-8">Sign in to manage your subscription.</p>
            <div id="googleBtnContainer" class="flex justify-center h-[50px]"></div>
        </div>
    </div>
    
    <div id="profileModal" class="fixed inset-0 bg-black/90 backdrop-blur-2xl z-[100] hidden items-center justify-center p-4">
      <div class="bg-[#0A0A0A] border border-white/20 rounded-3xl w-full max-w-md overflow-hidden relative shadow-2xl">
          <div class="p-8 border-b border-white/10 flex justify-between items-center bg-white/5"><div class="flex items-center gap-4"><img id="modalUserAvatar" class="w-14 h-14 rounded-full bg-slate-800 object-cover ring-2 ring-white/20" /><div class="font-bold text-white text-xl" id="modalUserName"></div></div><button onclick="closeProfileModal()" class="text-slate-500 hover:text-white text-xl"><i class="fa-solid fa-times"></i></button></div>
          <div class="p-8 space-y-6">
              <div class="bg-blue-600/10 border border-blue-500/30 rounded-2xl p-6"><div class="flex justify-between items-center mb-2"><p class="text-xs font-bold text-blue-400 uppercase tracking-widest">Plan</p><span id="modalPlanStatus" class="px-3 py-1 rounded-full text-[10px] font-bold bg-blue-500 text-white">ACTIVE</span></div><h3 id="modalPlanName" class="text-3xl font-black text-white">PRO ELITE</h3><div class="text-xs text-blue-200/60 mt-4 font-mono">RENEWS: <span id="modalExpiryDate" class="text-white">--</span></div></div>
              <button onclick="logout()" class="w-full py-4 rounded-xl border border-white/10 text-slate-400 hover:bg-white hover:text-black transition text-sm font-bold uppercase tracking-wider">Sign Out</button>
          </div>
      </div>
    </div>

    <script>
      // Configuration
      const BACKEND_URL="https://whis-backend.onrender.com";
      const GOOGLE_CLIENT_ID="91011354786-0giqfdd547vj6ojkk26qdj4jucl5v07p.apps.googleusercontent.com";
      
      // UI vars
      const loginModal=document.getElementById('loginModal');
      const downloadModal=document.getElementById('downloadModal');
      const profileModal=document.getElementById('profileModal');
      let currentUser=null;
        
      // CAROUSEL LOGIC (OPTIMIZED FOR NO HANGING)
      const videos = [
          { src: 'visual.mp4', label: 'MODE: SCREEN READING' },
          { src: 'text.mp4', label: 'MODE: CODE GENERATION' },
          { src: 'audio.mp4', label: 'MODE: AUDIO ANALYSIS' }
      ];
      let activeIndex = 0;
        
      document.addEventListener("DOMContentLoaded", () => {
          initCarousel();
          detectOS();
          checkUser();
      });

      function initCarousel() {
          const stage = document.getElementById('carouselStage');
          stage.innerHTML = ''; 
            
          videos.forEach((v, i) => {
              const div = document.createElement('div');
              div.className = 'carousel-item'; 
              div.id = `item-${i}`;
              
              // PERFORMANCE FIX: Only create video element for the active item initially
              // Or better: Create all but set preload=none, and only manage src based on active state
              // To prevent hanging, we use a placeholder for inactive, and video for active.
              
              const vidContainer = document.createElement('div');
              vidContainer.className = "w-full h-full bg-[#111] relative overflow-hidden";
              
              // Fallback/Loading state styling
              vidContainer.innerHTML = `<div class="absolute inset-0 flex items-center justify-center text-slate-700 font-mono text-xs">LOADING STREAM...</div>`;
              
              const vid = document.createElement('video');
              vid.src = v.src;
              vid.muted = true; vid.playsInline = true; vid.loop = true; 
              vid.className = "absolute inset-0 w-full h-full object-cover opacity-0 transition-opacity duration-500";
              vid.preload = "none"; // CRITICAL: Do not preload to stop hanging
              
              vidContainer.appendChild(vid);
              div.appendChild(vidContainer);
              stage.appendChild(div);
          });
            
          updateCarouselPositions();
      }

      function updateCarouselPositions() {
          const items = [document.getElementById('item-0'), document.getElementById('item-1'), document.getElementById('item-2')];
          const prevIndex = (activeIndex - 1 + 3) % 3;
          const nextIndex = (activeIndex + 1) % 3;
            
          // Clean classes
          items.forEach(el => el.className = 'carousel-item transition-all duration-700 ease-[cubic-bezier(0.16,1,0.3,1)]');
            
          // Set Positions
          items[activeIndex].classList.add('pos-center');
          items[prevIndex].classList.add('pos-left');
          items[nextIndex].classList.add('pos-right');
            
          // PERFORMANCE VIDEO MANAGER
          items.forEach((el, idx) => {
              const v = el.querySelector('video');
              if(idx === activeIndex) {
                  // Load and Play Active
                  v.style.opacity = '1';
                  if(v.paused) {
                      v.play().catch(e => console.log("Auto-play restricted"));
                  }
              } else {
                  // Unload/Pause Inactive to free memory
                  v.style.opacity = '0.5';
                  v.pause();
              }
          });

          // Indicators
          [0,1,2].forEach(i => {
              const ind = document.getElementById(`ind-${i}`);
              if(i === activeIndex) {
                  ind.className = "w-12 h-1.5 rounded-full bg-blue-500 transition-all shadow-[0_0_10px_#3b82f6]";
              } else {
                  ind.className = "w-2 h-1.5 rounded-full bg-white/20 hover:bg-white transition-all cursor-pointer";
              }
          });
            
          // Label
          document.getElementById('activeFeatureLabel').innerText = videos[activeIndex].label;
      }

      function manualSet(idx) { activeIndex = idx; updateCarouselPositions(); }

      function detectOS(){
          const p = navigator.platform.toLowerCase(); const ua = navigator.userAgent.toLowerCase();
          const btn = document.getElementById('smartDownloadBtn'); 
          const icon = document.getElementById('osIcon'); 
          const text = document.getElementById('osText');
            
          const winLink = "https://github.com/syedwaseemfahad/whis-releases/releases/download/v.1.0.windows/Whis.Setup.1.0.1.exe";
          const macLink = "https://github.com/syedwaseemfahad/whis-releases/releases/download/v1.0.0/Whis-1.0.0-arm64.dmg";

          if (p.includes('win')||ua.includes('win')) { 
              text.innerText="Download for Windows"; 
              icon.className="fa-brands fa-windows text-2xl"; 
              btn.onclick=()=>window.location.href=winLink; 
          }
          else { 
              text.innerText="Download for macOS"; 
              icon.className="fa-brands fa-apple text-2xl"; 
              btn.onclick=()=>window.location.href=macLink; 
          }
      }

      // --- Auth ---
      function checkUser(){ const s=localStorage.getItem('whisUser'); if(s){ try{ currentUser=JSON.parse(s); updateNavUI(currentUser); }catch(e){localStorage.removeItem('whisUser');} } }
      function openLoginModal(){loginModal.classList.remove('hidden');loginModal.classList.add('flex');if(window.google){google.accounts.id.initialize({client_id:GOOGLE_CLIENT_ID,callback:hGoogle});google.accounts.id.renderButton(document.getElementById("googleBtnContainer"),{theme:"filled_black",size:"large",shape:"pill"});}}
      function closeLoginModal(){loginModal.classList.add('hidden');loginModal.classList.remove('flex');}
      function openDownloadModal(){downloadModal.classList.remove('hidden');downloadModal.classList.add('flex');}
      function closeDownloadModal(){downloadModal.classList.add('hidden');downloadModal.classList.remove('flex');}
      function openProfileModal(){if(currentUser){document.getElementById('modalUserAvatar').src=currentUser.avatarUrl;document.getElementById('modalUserName').innerText=currentUser.name;fetchFullUserData(currentUser.googleId);}profileModal.classList.remove('hidden');profileModal.classList.add('flex');}
      function closeProfileModal(){profileModal.classList.add('hidden');profileModal.classList.remove('flex');}
      function logout(){localStorage.removeItem('whisUser');location.reload();}
      function updateNavUI(u){document.getElementById('signInBtn').style.display='none';document.getElementById('userProfileTrigger').classList.remove('hidden');document.getElementById('userProfileTrigger').classList.add('flex');document.getElementById('navUserAvatar').src=u.avatarUrl;}
      async function hGoogle(res){try{const r=await fetch(`${BACKEND_URL}/api/auth/google`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:res.credential})});if(r.ok){const d=await r.json();if(d.success){localStorage.setItem('whisUser',JSON.stringify(d.user));currentUser=d.user;updateNavUI(currentUser);closeLoginModal();fetchFullUserData(currentUser.googleId);}}}catch(e){}}
      async function fetchFullUserData(gid){try{const r=await fetch(`${BACKEND_URL}/api/user/status`,{headers:{'x-google-id':gid}});const d=await r.json();const b=document.getElementById('navPlanBadge');const mb=document.getElementById('modalPlanStatus');if(d.active){b.textContent=(d.tier==='pro_plus'?'ELITE':'PRO');mb.textContent="ACTIVE";mb.className="px-3 py-1 rounded-full text-[10px] font-bold bg-blue-500 text-white";document.getElementById('modalExpiryDate').textContent=new Date(d.validUntil).toLocaleDateString();}else{b.textContent="FREE";mb.textContent="INACTIVE";mb.className="px-3 py-1 rounded-full text-[10px] font-bold bg-slate-600 text-slate-300";document.getElementById('modalExpiryDate').textContent="Forever";}document.getElementById('modalPlanName').textContent=d.tier==='pro_plus'?'Pro Elite':(d.tier==='pro'?'Pro Plan':'Starter');}catch(e){}}
    </script>
</body>
</html>
