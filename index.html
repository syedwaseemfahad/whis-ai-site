<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-XXXXXXXXXX');
  </script>

  <meta charset="UTF-8" />
  <title>Whis-AI – Press Start to Win</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
  <meta name="description" content="The undetectable AI copilot that solves interview problems in real-time. Get the job, guaranteed.">
    
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { 
            sans: ['Rajdhani', 'sans-serif'], 
            retro: ['"Press Start 2P"', 'cursive'],
            mono: ['"JetBrains Mono"', 'monospace'] 
          },
          colors: { 
            page: '#090014', 
            panel: '#130421',
            glass: 'rgba(20, 0, 40, 0.6)',
            neonPink: '#ff00ff',
            neonBlue: '#00f2ff',
            neonGreen: '#0aff00',
            accent: 'var(--accent)',
          },
          backgroundImage: {
            'grid-pattern': "linear-gradient(to right, #2a1b3d 1px, transparent 1px), linear-gradient(to bottom, #2a1b3d 1px, transparent 1px)",
          },
          animation: { 
            'scroll': 'scroll 40s linear infinite',
            'float': 'float 4s ease-in-out infinite',
            'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'glow': 'glow 2s ease-in-out infinite alternate',
            'scanline': 'scanline 8s linear infinite',
            'pop-in': 'popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards',
          },
          keyframes: {
            scroll: { '0%': { transform: 'translateX(0)' }, '100%': { transform: 'translateX(-100%)' } },
            float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-15px)' } },
            glow: { '0%': { boxShadow: '0 0 5px var(--accent)' }, '100%': { boxShadow: '0 0 20px var(--accent), 0 0 10px #fff' } },
            scanline: { '0%': { transform: 'translateY(-100%)' }, '100%': { transform: 'translateY(100%)' } },
            popIn: {
                '0%': { opacity: '0', transform: 'scale(0.5)' },
                '100%': { opacity: '1', transform: 'scale(1)' }
            },
          }
        }
      }
    }
  </script>
    
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Press+Start+2P&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <script src="https://www.paypal.com/sdk/js?client-id=AWt11sXML_MxwSp4shnL-JDfXlqWe_wO7d_VVCvRNT00Ws-dHCTywlD9La4aWpNNJbfz-SGuWggCNgip&currency=USD"></script>
    
  <style>
    /* --- CORE GAMER AESTHETICS --- */
    :root {
        --accent: #ff00ff;
        --accent-sec: #00f2ff;
        --accent-glow: rgba(255, 0, 255, 0.6);
    }
    
    @property --accent {
        syntax: '<color>';
        initial-value: #ff00ff;
        inherits: true;
    }

    html {
        scroll-behavior: smooth;
    }

    body { 
        background-color: #05000a; 
        color: #e2e8f0; 
        font-family: 'Rajdhani', sans-serif; 
        overflow-x: hidden; 
        padding-bottom: 90px;
        background-image: 
            radial-gradient(circle at 50% 0%, #1a0b2e 0%, transparent 70%),
            linear-gradient(rgba(0, 242, 255, 0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(0, 242, 255, 0.03) 1px, transparent 1px);
        background-size: 100% 100%, 40px 40px, 40px 40px;
        background-position: 0 0, 0 0, 0 0;
    }

    /* --- GAMIFIED UI ELEMENTS --- */

    /* 3D Pressable Buttons */
    .game-btn {
        position: relative;
        border: none;
        transition: all 0.1s;
        transform: translateY(0);
        cursor: pointer;
    }
    .game-btn:active {
        transform: translateY(4px);
        box-shadow: 0px 0px 0px !important;
    }
    
    /* HUD Card Style */
    .hud-card {
        background: rgba(19, 4, 33, 0.7);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 0, 255, 0.3);
        box-shadow: 0 0 15px rgba(255, 0, 255, 0.1), inset 0 0 20px rgba(0,0,0,0.5);
        border-radius: 12px;
        position: relative;
        overflow: hidden;
    }
    /* Corner Accents */
    .hud-card::before {
        content: ''; position: absolute; top: 0; left: 0; width: 10px; height: 10px;
        border-top: 2px solid var(--accent-sec); border-left: 2px solid var(--accent-sec);
    }
    .hud-card::after {
        content: ''; position: absolute; bottom: 0; right: 0; width: 10px; height: 10px;
        border-bottom: 2px solid var(--accent-sec); border-right: 2px solid var(--accent-sec);
    }

    /* Glitch Text Effect */
    .glitch-text {
        position: relative;
    }
    .glitch-text::before, .glitch-text::after {
        content: attr(data-text);
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background: #05000a;
    }
    .glitch-text::before {
        left: 2px; text-shadow: -1px 0 #ff00c1; clip: rect(44px, 450px, 56px, 0);
        animation: glitch-anim 5s infinite linear alternate-reverse;
    }
    .glitch-text::after {
        left: -2px; text-shadow: -1px 0 #00fff9; clip: rect(44px, 450px, 56px, 0);
        animation: glitch-anim2 5s infinite linear alternate-reverse;
    }

    @keyframes glitch-anim {
        0% { clip: rect(11px, 9999px, 81px, 0); }
        20% { clip: rect(83px, 9999px, 40px, 0); }
        40% { clip: rect(25px, 9999px, 96px, 0); }
        60% { clip: rect(2px, 9999px, 2px, 0); }
        80% { clip: rect(43px, 9999px, 64px, 0); }
        100% { clip: rect(54px, 9999px, 44px, 0); }
    }
    @keyframes glitch-anim2 {
        0% { clip: rect(22px, 9999px, 11px, 0); }
        20% { clip: rect(56px, 9999px, 63px, 0); }
        40% { clip: rect(14px, 9999px, 18px, 0); }
        60% { clip: rect(67px, 9999px, 85px, 0); }
        80% { clip: rect(32px, 9999px, 54px, 0); }
        100% { clip: rect(98px, 9999px, 12px, 0); }
    }

    /* --- CAROUSEL 3D --- */
    .carousel-container { 
        perspective: 1200px; 
        display: flex; justify-content: center; align-items: center; 
        height: 250px; position: relative; margin: 20px 0;
    }
    @media (min-width: 768px) { .carousel-container { height: 600px; margin: 0; } }
    
    .carousel-item { 
        position: absolute; width: 90%; aspect-ratio: 16/9; 
        transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); 
        border-radius: 12px; overflow: hidden; background: #000; 
        border: 2px solid #333; 
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
    }
    @media (min-width: 768px) { .carousel-item { width: 80%; } }
    
    .item-center { z-index: 30; transform: translate3d(0,0,0) scale(1); opacity: 1; border-color: var(--accent-sec); box-shadow: 0 0 40px rgba(0, 242, 255, 0.4); }
    .item-left { z-index: 10; transform: translate3d(-50%, 0, -200px) rotateY(15deg) scale(0.85); opacity: 0.4; filter: grayscale(100%); }
    .item-right { z-index: 10; transform: translate3d(50%, 0, -200px) rotateY(-15deg) scale(0.85); opacity: 0.4; filter: grayscale(100%); }
    
    .item-hidden { z-index: 0; opacity: 0; transform: scale(0.5); }
    
    /* Overlay Title on Video */
    .video-label-overlay {
        position: absolute; bottom: 0; left: 0; right: 0;
        background: linear-gradient(to top, #130421, transparent);
        padding: 20px; opacity: 0; transition: opacity 0.5s; z-index: 5;
    }
    .item-center .video-label-overlay { opacity: 1; }

    /* --- CODE EDITOR GAME STYLE --- */
    pre { white-space: pre-wrap; margin: 0; font-family: 'JetBrains Mono', monospace; overflow-x: hidden; }
    .keyword { color: #ff00ff; text-shadow: 0 0 5px rgba(255,0,255,0.5); } 
    .function { color: #00f2ff; } 
    .string { color: #0aff00; } 
    .number { color: #ffcc00; } 

    /* --- UTILITIES --- */
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

    .faq-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
    .faq-active .faq-content { max-height: 300px; }
    .faq-active i { transform: rotate(180deg); color: var(--accent); }
    .snap-center { scroll-snap-align: center; }

    /* --- MODALS --- */
    .modal-backdrop {
        background: rgba(5, 0, 10, 0.95);
        backdrop-filter: blur(10px);
    }
  </style>
</head>
<body>

  <div class="fixed inset-0 z-[5] pointer-events-none opacity-[0.03] bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.25)_50%),linear-gradient(90deg,rgba(255,0,0,0.06),rgba(0,255,0,0.02),rgba(0,0,255,0.06))] bg-[length:100%_2px,3px_100%]"></div>

  <div id="celebrationModal" class="fixed inset-0 z-[1000] hidden items-center justify-center modal-backdrop transition-opacity duration-500">
      <button onclick="closeCelebration()" class="absolute top-6 right-6 text-white/50 hover:text-white transition hover:scale-110 z-50">
          <i class="fa-solid fa-xmark text-3xl"></i>
      </button>

      <div class="relative z-10 text-center p-6 max-w-xl w-full flex flex-col items-center animate-pop-in">
          
          <div class="w-24 h-24 mb-6 rounded-full border-4 border-[#ffcc00] flex items-center justify-center bg-black/50 shadow-[0_0_50px_rgba(255,204,0,0.4)] relative">
               <span class="absolute -top-3 bg-[#ffcc00] text-black text-[10px] font-bold px-2 py-0.5 rounded font-retro">LVL UP</span>
              <i class="fa-solid fa-trophy text-5xl text-[#ffcc00] animate-bounce"></i>
          </div>
          
          <h2 class="text-5xl md:text-7xl font-bold text-white mb-2 italic tracking-tighter" style="text-shadow: 4px 4px 0px #ff00ff;">QUEST COMPLETE!</h2>
          <p class="text-xl text-neonBlue font-mono mb-8 tracking-widest uppercase">&lt; REWARD UNLOCKED &gt;</p>
          
          <div class="bg-panel border-2 border-neonPink/30 rounded-xl p-6 mb-8 w-full relative overflow-hidden group">
              <div class="absolute inset-0 bg-neonPink/10 translate-x-[-100%] group-hover:translate-x-[100%] transition duration-1000"></div>
              <p class="text-slate-300 text-lg">
                  You received <span class="text-[#ffcc00] font-bold">3x ELITE PASSES</span>. Use them to bypass any interview defense system.
              </p>
          </div>

          <div class="flex items-center gap-4 mb-6">
             <div class="text-[#ffcc00] font-mono text-2xl font-bold" id="countdownTimer">10</div>
             <span class="text-xs text-slate-500 uppercase">Seconds remaining</span>
          </div>

          <button onclick="closeCelebration()" class="game-btn w-full py-4 rounded-lg bg-[#ffcc00] text-black text-xl font-bold uppercase tracking-widest shadow-[0_4px_0_#b28f00] hover:brightness-110">
              CLAIM LOOT
          </button>
      </div>
  </div>

  <nav class="fixed top-0 w-full z-50 h-[80px] flex items-center justify-center bg-panel/90 backdrop-blur-md border-b-2 border-white/5">
    <div class="w-full max-w-7xl px-6 flex items-center justify-between">
      <a href="/" class="flex items-center gap-3 group">
        <div class="w-10 h-10 rounded bg-neonPink/20 border border-neonPink flex items-center justify-center shadow-[0_0_15px_var(--accent-glow)]">
            <i class="fa-solid fa-gamepad text-neonPink text-lg"></i>
        </div>
        <span class="text-2xl font-bold tracking-tight text-white group-hover:text-neonPink transition uppercase" style="font-family: 'Press Start 2P', cursive; font-size: 14px; line-height: 1.5;">Whis-AI</span>
      </a>
      
      <div class="hidden md:flex items-center gap-2 bg-black/40 p-1.5 rounded-lg border border-white/10">
        <a href="#features" class="px-6 py-2 text-sm font-bold text-slate-400 hover:text-white hover:bg-white/10 rounded transition uppercase tracking-wide">Stats</a>
        <a href="#demo" class="px-6 py-2 text-sm font-bold text-slate-400 hover:text-white hover:bg-white/10 rounded transition uppercase tracking-wide">Gameplay</a>
        <a href="#pricing" class="px-6 py-2 text-sm font-bold text-slate-400 hover:text-white hover:bg-white/10 rounded transition uppercase tracking-wide">Shop</a>
      </div>

      <div class="flex items-center gap-4">
          <button onclick="openLoginModal()" id="signInBtn" class="text-sm font-bold text-neonBlue hover:text-white transition px-2 uppercase tracking-wide">[ Login ]</button>
          
          <button onclick="openDownloadModal()" class="hidden md:flex game-btn items-center gap-2 px-6 py-2.5 rounded bg-neonPink text-white text-sm font-bold uppercase shadow-[0_4px_0_#990099] hover:translate-y-[2px] hover:shadow-[0_2px_0_#990099] transition-all">
             <i class="fa-solid fa-download"></i> Get The Cheat
          </button>
          
          <button onclick="openProfileModal()" id="userProfileTrigger" class="hidden items-center gap-3 bg-white/5 pr-4 pl-1 py-1 rounded-full border border-white/10 hover:border-white/30 transition">
            <img id="navUserAvatar" src="" class="w-8 h-8 rounded-full border border-white/20" />
            <div class="flex flex-col items-start">
                <span id="navUserName" class="text-[10px] text-white font-bold leading-none">PLAYER 1</span>
                <span id="navPlanBadge" class="text-[9px] font-bold text-neonBlue uppercase tracking-wide">NOOB</span>
            </div>
          </button>
      </div>
    </div>
  </nav>

  <div class="md:hidden fixed bottom-0 left-0 right-0 z-50 bg-panel border-t-2 border-neonPink p-4 pb-8 flex flex-col gap-2 shadow-[0_-10px_40px_rgba(0,0,0,0.8)]">
      <div class="text-[10px] text-center text-neonGreen uppercase tracking-widest font-bold mb-1 font-mono">Server Status: High Load (150+)</div>
      <button onclick="openDownloadModal()" class="game-btn w-full py-4 rounded bg-neonBlue text-black text-sm font-black text-center shadow-[0_4px_0_#008c94] uppercase tracking-widest">
          Start Game
      </button>
  </div>

  <a href="https://wa.me/9092435258" target="_blank" class="fixed bottom-28 right-4 z-40 bg-[#25D366] w-14 h-14 rounded-xl flex items-center justify-center shadow-[0_5px_0_#1da851] hover:scale-105 transition md:bottom-8 group border-2 border-black">
      <i class="fa-brands fa-whatsapp text-white text-3xl"></i>
  </a>

  <section class="relative pt-32 md:pt-48 pb-12 flex flex-col items-center overflow-hidden min-h-screen">
    <div class="absolute inset-0 pointer-events-none">
        <div class="absolute top-[20%] left-[10%] w-32 h-32 bg-neonPink rounded-full blur-[100px] opacity-20 animate-pulse-fast"></div>
        <div class="absolute top-[40%] right-[10%] w-40 h-40 bg-neonBlue rounded-full blur-[100px] opacity-20 animate-pulse-fast" style="animation-delay: 1s"></div>
    </div>

    <div class="relative z-10 text-center max-w-6xl px-6 mb-2 flex flex-col items-center">
      
      <div class="mb-8 inline-flex items-center gap-3 px-6 py-2 rounded border border-neonGreen/30 bg-black/40 backdrop-blur-md">
          <div class="w-2 h-2 bg-neonGreen rounded-full animate-ping"></div>
          <span id="signup-badge-text" class="text-neonGreen font-mono text-xs font-bold uppercase tracking-widest">System Online: 152 Players Active</span>
      </div>
      
      <h1 class="glitch-text text-5xl md:text-8xl font-black tracking-tighter leading-[0.9] mb-8 text-white uppercase" data-text="Activate God Mode">
        Activate <br>
        <span class="text-transparent bg-clip-text bg-gradient-to-r from-neonBlue to-neonPink">God Mode</span>
      </h1>
      
      <p class="text-lg md:text-2xl text-slate-300 max-w-2xl mx-auto mb-10 font-medium">
        The ultimate cheat code for interviews. Sees the screen. Hears the question. <span class="text-neonBlue">Auto-plays the solution.</span>
      </p>

      <div class="flex flex-col items-center gap-6 w-full md:w-auto">
        <button id="heroDownloadBtn" onclick="openDownloadModal()" class="game-btn group w-full md:w-auto px-16 py-6 rounded bg-white text-black text-lg font-black uppercase tracking-widest shadow-[0_6px_0_#999] hover:bg-slate-100 flex items-center gap-4">
            <i class="fa-solid fa-play text-neonPink"></i> PRESS START
        </button>
        <p class="text-[10px] text-slate-500 font-mono uppercase tracking-widest"><i class="fa-solid fa-shield-halved text-neonGreen"></i> Anti-Cheat Undetected</p>
      </div>
    </div>

    <div class="w-full max-w-7xl mx-auto mt-16 mb-12 relative px-6 opacity-60 z-30">
        <div class="flex overflow-hidden group border-y border-white/5 py-6 bg-black/20">
            <div class="flex gap-16 animate-scroll whitespace-nowrap">
                <span class="text-xl font-bold font-retro text-white/30">GOOGLE</span>
                <span class="text-xl font-bold font-retro text-white/30">META</span>
                <span class="text-xl font-bold font-retro text-white/30">AMAZON</span>
                <span class="text-xl font-bold font-retro text-white/30">NETFLIX</span>
                <span class="text-xl font-bold font-retro text-white/30">UBER</span>
                <span class="text-xl font-bold font-retro text-white/30">MICROSOFT</span>
                <span class="text-xl font-bold font-retro text-white/30">GOOGLE</span>
                <span class="text-xl font-bold font-retro text-white/30">META</span>
                <span class="text-xl font-bold font-retro text-white/30">AMAZON</span>
            </div>
        </div>
    </div>

    <div class="w-full relative z-20">
        <div class="carousel-container" id="carouselContainer"></div>
        <div class="text-center mt-6">
              <div class="inline-block border border-neonBlue px-4 py-1 rounded bg-neonBlue/10">
                  <p id="featureLabel" class="text-xs font-mono text-neonBlue uppercase tracking-[0.3em] font-bold">Initializing...</p>
              </div>
        </div>
    </div>
  </section>

  <section id="demo" class="py-24 border-t-2 border-white/5 bg-[#0b0514] relative">
      <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-neonPink to-transparent opacity-50"></div>
      
      <div class="max-w-7xl mx-auto px-6">
          <div class="grid lg:grid-cols-2 gap-16 items-center">
              <div class="space-y-8">
                  <h2 class="text-4xl md:text-6xl font-black text-white uppercase tracking-tight leading-none">
                      Real-Time <br><span class="text-neonGreen">Assist Bot.</span>
                  </h2>
                  <p class="text-slate-400 text-lg">
                      Whis captures audio and video streams like a game overlay. It calculates the optimal path (algorithm) and executes the commands directly into your IDE.
                  </p>
                  
                  <div class="hud-card p-8">
                      <div class="flex items-center justify-between mb-6 border-b border-white/10 pb-4">
                          <span class="text-xs font-mono text-neonPink uppercase tracking-widest animate-pulse">● Audio Input</span>
                          <i class="fa-solid fa-signal text-neonPink"></i>
                      </div>
                      <p class="text-xl text-white font-mono leading-relaxed">
                          <span class="text-slate-500">></span> "Optimize for time complexity..."<br>
                          <span class="text-neonGreen">> Calculating O(n) solution...</span><br>
                          <span class="text-neonGreen">> Solution Ready.</span>
                      </p>
                  </div>
              </div>

              <div class="hud-card p-0 h-[450px] flex flex-col shadow-[0_0_40px_rgba(0,242,255,0.1)]">
                  <div class="px-4 py-3 bg-black/60 border-b border-white/10 flex justify-between items-center">
                      <div class="flex gap-2">
                        <div class="w-3 h-3 rounded-sm bg-red-500"></div>
                        <div class="w-3 h-3 rounded-sm bg-yellow-500"></div>
                        <div class="w-3 h-3 rounded-sm bg-green-500"></div>
                      </div>
                      <span class="text-xs font-mono text-slate-500">MAIN.PY</span>
                  </div>
                  <div class="p-6 flex-grow overflow-hidden relative bg-[#090014]">
                      <div class="absolute top-0 bottom-0 left-0 w-10 border-r border-white/5 text-right pr-2 pt-6 text-slate-700 font-mono text-xs select-none">
                          1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9
                      </div>
                      <div class="pl-12 h-full overflow-hidden">
                        <pre id="code-display" class="text-sm leading-relaxed text-slate-300 font-mono"></pre>
                        <span id="cursor" class="w-2 h-5 bg-neonPink animate-pulse inline-block align-middle ml-1"></span>
                      </div>
                  </div>
                  <div class="px-4 py-2 border-t border-white/10 bg-green-900/20 text-xs font-mono text-neonGreen flex justify-between">
                      <span>STATUS: PASSED</span>
                      <span>RUNTIME: 12ms (Top 1%)</span>
                  </div>
              </div>
          </div>
      </div>
  </section>

  <section class="py-24 bg-[#05000a] border-t border-white/5 relative overflow-hidden">
      <div class="max-w-7xl mx-auto px-6 text-center relative z-10">
          <span class="inline-block py-1 px-3 border border-neonPink rounded text-neonPink text-xs font-bold uppercase tracking-widest mb-6 bg-neonPink/10">Stealth Tech</span>
          <h2 class="text-4xl md:text-6xl font-black text-white mb-16 uppercase">Invisible Overlay</h2>
          
          <div class="grid md:grid-cols-2 gap-8 max-w-5xl mx-auto">
                <div class="hud-card p-2 group hover:scale-[1.02] transition duration-500">
                    <div class="bg-black/80 p-6 rounded h-full relative overflow-hidden">
                        <div class="absolute top-0 right-0 bg-slate-700 text-white text-[10px] font-bold px-3 py-1 rounded-bl">THEIR SCREEN</div>
                        <div class="aspect-video bg-[#111] rounded border border-white/10 flex items-center justify-center mb-6">
                             <i class="fa-solid fa-desktop text-5xl text-slate-600"></i>
                        </div>
                        <h3 class="text-white font-bold mb-2">Clean Feed</h3>
                        <p class="text-sm text-slate-400">They see your desktop. Just your desktop. No overlay. No weird artifacts.</p>
                    </div>
                </div>

                <div class="hud-card p-2 group hover:scale-[1.02] transition duration-500 border-neonBlue">
                    <div class="bg-black/80 p-6 rounded h-full relative overflow-hidden">
                         <div class="absolute top-0 right-0 bg-neonBlue text-black text-[10px] font-bold px-3 py-1 rounded-bl">YOUR SCREEN</div>
                         <div class="aspect-video bg-[#111] rounded border border-neonBlue/30 flex items-center justify-center mb-6 relative overflow-hidden">
                             <i class="fa-solid fa-desktop text-5xl text-slate-600 opacity-50"></i>
                             <div class="absolute right-0 top-0 bottom-0 w-1/3 bg-black/80 border-l border-neonBlue p-2 flex flex-col gap-2">
                                 <div class="h-1 w-full bg-neonBlue rounded"></div>
                                 <div class="h-8 w-full bg-neonBlue/10 border border-neonBlue/30 rounded"></div>
                                 <div class="h-1 w-2/3 bg-slate-700 rounded"></div>
                             </div>
                        </div>
                        <h3 class="text-white font-bold mb-2 text-neonBlue">Augmented Reality</h3>
                        <p class="text-sm text-slate-400">You see hints, code snippets, and system design diagrams overlaid on top.</p>
                    </div>
                </div>
          </div>
      </div>
  </section>

  <section id="features" class="py-24 border-t border-white/5 bg-page">
      <div class="max-w-7xl mx-auto px-6">
          <h2 class="text-4xl font-black text-white mb-16 text-center uppercase">Your Inventory</h2>
          
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
              <div class="hud-card p-8 group hover:bg-white/5 transition">
                  <i class="fa-solid fa-ghost text-4xl text-neonPink mb-6 group-hover:scale-110 transition inline-block"></i>
                  <h3 class="text-xl text-white font-bold mb-3 uppercase font-retro text-sm">Ghost Mode</h3>
                  <p class="text-sm text-slate-400">Bypasses all known proctoring software screen capture hooks.</p>
              </div>
              
              <div class="hud-card p-8 group hover:bg-white/5 transition">
                  <i class="fa-solid fa-eye text-4xl text-neonBlue mb-6 group-hover:scale-110 transition inline-block"></i>
                  <h3 class="text-xl text-white font-bold mb-3 uppercase font-retro text-sm">Vision AI</h3>
                  <p class="text-sm text-slate-400">Analyzes shared whiteboard diagrams to solve system design problems.</p>
              </div>

              <div class="hud-card p-8 group hover:bg-white/5 transition">
                  <i class="fa-solid fa-language text-4xl text-neonGreen mb-6 group-hover:scale-110 transition inline-block"></i>
                  <h3 class="text-xl text-white font-bold mb-3 uppercase font-retro text-sm">Polyglot</h3>
                  <p class="text-sm text-slate-400">Translates incoming audio from any language to code instantly.</p>
              </div>
          </div>
      </div>
  </section>

  <section id="pricing" class="py-24 border-t border-white/5 bg-[#08020d] relative">
    <div class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-[0.05]"></div>
    
    <div class="max-w-7xl mx-auto px-6 text-center relative z-10">
        <h2 class="text-5xl font-black text-white mb-4 uppercase italic">Item Shop</h2>
        <p class="text-slate-400 mb-12 font-mono">Select your loadout.</p>
        
        <div class="inline-flex bg-white/5 p-1 rounded mb-12 border border-white/10">
           <button id="btnMonthly" class="px-8 py-2 rounded text-xs font-bold bg-neonBlue text-black shadow-lg uppercase" onclick="setCycle('monthly')">Monthly</button>
           <button id="btnAnnual" class="px-8 py-2 rounded text-xs font-bold text-slate-500 hover:text-white transition uppercase" onclick="setCycle('annual')">Yearly (-20%)</button>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto items-stretch">
            
            <div class="hud-card p-8 text-left flex flex-col h-full hover:border-white/40 transition">
                <h3 class="text-sm font-bold text-slate-400 uppercase tracking-widest mb-4 font-retro">Starter Kit</h3>
                <div class="text-5xl font-black text-white mb-2">FREE</div>
                <div class="space-y-4 text-xs text-slate-400 mt-8 mb-8 flex-grow font-mono">
                    <div class="bg-neonPink/10 border border-neonPink/30 p-3 rounded text-white font-bold mb-4">
                        <i class="fa-solid fa-gift text-neonPink mr-2"></i> 3x ELITE PASSES
                    </div>
                    <p>● 10 Daily Uses</p>
                    <p>● Basic Code Gen</p>
                </div>
                <button onclick="openDownloadModal()" class="game-btn w-full py-4 rounded bg-white/10 border border-white/20 text-white font-bold uppercase hover:bg-white/20">Equip</button>
            </div>

            <div class="hud-card p-8 text-left flex flex-col h-full hover:border-white/40 transition">
                <h3 class="text-sm font-bold text-neonBlue uppercase tracking-widest mb-4 font-retro">Pro Gear</h3>
                <div class="text-5xl font-black text-white mb-6" id="pricePro">...</div>
                <div class="space-y-4 text-xs text-slate-300 mb-8 flex-grow font-mono">
                    <p>● Unlimited Ammo (Uses)</p>
                    <p>● Visual Analysis</p>
                    <p>● Audio Ingestion</p>
                </div>
                <button id="btnPro" disabled onclick="initiatePayment('pro')" class="game-btn w-full py-4 rounded bg-white text-black font-black uppercase shadow-[0_4px_0_#999] hover:translate-y-[2px] disabled:opacity-50">Buy Pro</button>
            </div>

            <div class="hud-card p-8 text-left flex flex-col h-full border-neonPink shadow-[0_0_30px_rgba(255,0,255,0.15)] relative transform md:-translate-y-4 bg-[#1a0b2e]">
                <div class="absolute top-0 right-0 bg-neonPink text-white text-[10px] font-bold px-3 py-1 font-retro">BEST VALUE</div>
                <h3 class="text-sm font-bold text-neonPink uppercase tracking-widest mb-4 font-retro">God Mode</h3>
                <div class="text-5xl font-black text-white mb-6" id="priceStealth">...</div>
                <div class="space-y-4 text-xs text-white mb-8 flex-grow font-mono">
                    <p class="text-neonPink font-bold">● 100% INVISIBLE</p>
                    <p>● Ghost Dock Icon</p>
                    <p>● Direct Input Mode</p>
                    <p>● Priority Support</p>
                </div>
                <button id="btnElite" disabled onclick="initiatePayment('pro_plus')" class="game-btn w-full py-4 rounded bg-gradient-to-r from-neonPink to-purple-600 text-white font-black uppercase shadow-[0_4px_0_#5b005b] hover:translate-y-[2px] disabled:opacity-50">Unlock God Mode</button>
            </div>
        </div>
    </div>
  </section>

  <section class="py-20 bg-page border-t border-white/5">
      <div class="max-w-3xl mx-auto px-6">
          <h2 class="text-2xl font-bold text-white mb-10 text-center uppercase font-retro">Tutorial / FAQ</h2>
          <div class="space-y-4">
              <div class="hud-card bg-black" onclick="this.classList.toggle('faq-active')">
                  <div class="p-5 flex justify-between items-center cursor-pointer">
                      <span class="text-sm font-bold text-slate-200 uppercase tracking-wide">Is this really undetectable?</span>
                      <i class="fa-solid fa-chevron-down text-slate-500 transition-transform duration-300"></i>
                  </div>
                  <div class="faq-content px-5">
                      <p class="text-xs text-slate-400 py-4 font-mono">Yes. We use a custom graphics layer that sits 'above' the OS capture hook. It's like a wallhack for your screen.</p>
                  </div>
              </div>
              <div class="hud-card bg-black" onclick="this.classList.toggle('faq-active')">
                  <div class="p-5 flex justify-between items-center cursor-pointer">
                      <span class="text-sm font-bold text-slate-200 uppercase tracking-wide">Platform Support?</span>
                      <i class="fa-solid fa-chevron-down text-slate-500 transition-transform duration-300"></i>
                  </div>
                  <div class="faq-content px-5">
                      <p class="text-xs text-slate-400 py-4 font-mono">macOS (Silicon & Intel) and Windows 10/11.</p>
                  </div>
              </div>
          </div>
      </div>
  </section>

  <footer class="py-12 bg-black border-t border-white/10 flex flex-col items-center gap-6 pb-32 md:pb-12">
    <div class="flex flex-wrap justify-center gap-8 text-slate-500 text-xs font-mono uppercase">
        <a href="/terms" class="hover:text-neonPink transition">Terms</a>
        <a href="/privacy" class="hover:text-neonPink transition">Privacy</a>
        <a href="/refund-policy" class="hover:text-neonPink transition">Refunds</a>
    </div>
    <p class="text-slate-700 text-[10px] uppercase font-bold tracking-widest">© 2024 Whis-AI / GG NO RE</p>
  </footer>

  <div id="loginModal" class="fixed inset-0 z-[100] hidden items-center justify-center p-4 modal-backdrop">
      <div class="hud-card p-10 max-w-sm w-full text-center relative">
        <button onclick="closeLoginModal()" class="absolute top-4 right-4 text-slate-500 hover:text-white"><i class="fa-solid fa-times"></i></button>
        <h3 class="text-xl font-bold text-white mb-2 uppercase font-retro">Login</h3>
        <p class="text-xs text-slate-400 mb-8 font-mono">Load your save file.</p>
        <div id="googleBtnContainer" class="flex justify-center h-[50px] overflow-hidden"></div>
      </div>
  </div>

  <div id="successModal" class="fixed inset-0 z-[200] hidden items-center justify-center p-4 modal-backdrop">
      <div class="hud-card p-8 max-w-sm w-full text-center border-neonGreen">
          <i class="fa-solid fa-check-circle text-5xl text-neonGreen mb-6"></i>
          <h3 class="text-xl font-bold text-white mb-2 font-retro">UPGRADE SUCCESS</h3>
          <p class="text-slate-400 text-xs font-mono mb-8">Capabilities Maxed Out.</p>
          <button onclick="window.location.reload()" class="game-btn w-full py-3 rounded bg-neonGreen text-black font-bold uppercase shadow-[0_4px_0_#00cc00]">Reload System</button>
      </div>
  </div>

  <div id="paymentModal" class="fixed inset-0 z-[150] hidden items-center justify-center p-4 modal-backdrop">
    <div class="hud-card p-8 max-w-sm w-full text-center relative">
        <button onclick="closePaymentModal()" class="absolute top-4 right-4 text-slate-500 hover:text-white"><i class="fa-solid fa-times"></i></button>
        <h3 class="text-xl font-bold text-white mb-2 font-retro">CHECKOUT</h3>
        <p class="text-xs text-slate-400 mb-8 font-mono">Secure Transaction</p>

        <button onclick="triggerRazorpayFlow(event)" class="game-btn w-full py-3.5 mb-4 rounded bg-[#3395ff] text-white font-bold flex items-center justify-center gap-3 shadow-[0_4px_0_#0055aa]">
            <i class="fa-solid fa-credit-card"></i> Pay via Card / UPI
        </button>

        <div class="relative flex py-2 items-center mb-4 opacity-50">
            <div class="flex-grow border-t border-white/10"></div>
            <span class="flex-shrink mx-4 text-[10px] text-slate-500 font-mono">GLOBAL SERVER</span>
            <div class="flex-grow border-t border-white/10"></div>
        </div>

        <div id="paypal-button-container" class="w-full min-h-[45px]"></div>
    </div>
  </div>

  <div id="downloadModal" class="fixed inset-0 z-[100] hidden items-center justify-center p-4 modal-backdrop">
    <div class="hud-card p-8 max-w-md w-full">
        <button onclick="closeDownloadModal()" class="absolute top-4 right-4 text-slate-500 hover:text-white"><i class="fa-solid fa-times"></i></button>
        <h3 class="text-lg font-bold text-white mb-6 uppercase font-retro text-center">Select Platform</h3>
        <div class="space-y-4">
            <a href="https://github.com/syedwaseemfahad/whis-releases/releases/download/v.1.4.mac/Whis-1.0.1-arm64.dmg" class="flex items-center justify-between p-4 bg-white/5 rounded hover:bg-white/10 transition group border border-white/5 hover:border-neonPink">
                <span class="flex items-center gap-4 text-sm text-white font-bold font-mono">
                    <i class="fa-brands fa-apple text-xl"></i> macOS (Silicon)
                </span>
                <i class="fa-solid fa-download text-slate-500 group-hover:text-neonPink transition"></i>
            </a>
             <a href="https://github.com/syedwaseemfahad/whis-releases/releases/download/v.1.4.mac/Whis-1.0.1-arm64.dmg" class="flex items-center justify-between p-4 bg-white/5 rounded hover:bg-white/10 transition group border border-white/5 hover:border-neonPink">
                <span class="flex items-center gap-4 text-sm text-white font-bold font-mono">
                    <i class="fa-brands fa-apple text-xl"></i> macOS (Intel)
                </span>
                <i class="fa-solid fa-download text-slate-500 group-hover:text-neonPink transition"></i>
            </a>
            <a href="https://github.com/syedwaseemfahad/whis-releases/releases/download/v.1.4.windows/Whis.Setup.1.0.1.exe" class="flex items-center justify-between p-4 bg-white/5 rounded hover:bg-white/10 transition group border border-white/5 hover:border-neonBlue">
                <span class="flex items-center gap-4 text-sm text-white font-bold font-mono">
                      <i class="fa-brands fa-windows text-xl"></i> Windows 10 / 11
                </span>
                <i class="fa-solid fa-download text-slate-500 group-hover:text-neonBlue transition"></i>
            </a>
        </div>
        <p class="text-[10px] text-center text-neonGreen mt-6 pt-4 border-t border-white/5 font-mono">BONUS: +3 Elite Sessions included with download.</p>
    </div>
  </div>

  <div id="profileModal" class="fixed inset-0 z-[100] hidden items-center justify-center p-4 modal-backdrop">
    <div class="hud-card p-8 max-w-sm w-full text-center">
        <button onclick="closeProfileModal()" class="absolute top-4 right-4 text-slate-500 hover:text-white"><i class="fa-solid fa-times"></i></button>
        <img id="modalUserAvatar" class="w-20 h-20 rounded-full mx-auto mb-4 border-2 border-neonPink p-1 object-cover" />
        <h3 id="modalUserName" class="text-lg font-bold text-white mb-6 font-mono">PLAYER</h3>
        <div class="bg-black/40 rounded p-6 text-left mb-6 border border-white/10">
            <p class="text-[10px] text-slate-500 uppercase tracking-widest mb-1 font-mono">Current Rank</p>
            <div class="flex justify-between items-baseline">
                <span id="modalPlanName" class="text-xl font-bold text-white font-retro">ROOKIE</span>
                <span id="modalPlanStatus" class="text-[10px] bg-neonGreen/20 text-neonGreen px-2 py-0.5 rounded border border-neonGreen/30">ONLINE</span>
            </div>
            <div id="modalPlanValidity" class="text-[10px] text-slate-400 mt-2 font-mono"></div>
        </div>
        <button onclick="logout()" class="game-btn w-full py-3 rounded bg-red-900/20 text-red-500 border border-red-500/50 hover:bg-red-900/40 text-xs font-bold uppercase shadow-[0_4px_0_#500]">Log Out</button>
    </div>
  </div>

  <script>
    // --- CELEBRATION LOGIC (UPDATED WITH 10s TIMER & CLOSE) ---
    let celebrationInterval;
    let confettiInterval;

    function triggerCelebration() {
        const modal = document.getElementById('celebrationModal');
        modal.classList.remove('hidden');
        modal.classList.add('flex');

        const audio = new Audio('https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3'); // Changed to Level Up Sound
        audio.volume = 0.5;
        audio.play().catch(e => console.log("Audio autoplay blocked"));

        fireContinuousConfetti();
        startCountdown();
    }

    function fireContinuousConfetti() {
        const duration = 10000;
        const animationEnd = Date.now() + duration;
        const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 2000, colors: ['#ff00ff', '#00f2ff', '#ffe600'] };

        function random(min, max) { return Math.random() * (max - min) + min; }

        confettiInterval = setInterval(function() {
          const timeLeft = animationEnd - Date.now();

          if (timeLeft <= 0) {
            return clearInterval(confettiInterval);
          }

          const particleCount = 50 * (timeLeft / duration);
          confetti(Object.assign({}, defaults, { particleCount, origin: { x: random(0.1, 0.3), y: Math.random() - 0.2 } }));
          confetti(Object.assign({}, defaults, { particleCount, origin: { x: random(0.7, 0.9), y: Math.random() - 0.2 } }));
        }, 250);
    }

    function startCountdown() {
        let timeLeft = 10;
        const timerEl = document.getElementById('countdownTimer');
        
        celebrationInterval = setInterval(() => {
            timeLeft--;
            if(timeLeft >= 0) {
                timerEl.innerText = timeLeft;
            }
            if(timeLeft <= 0) {
                closeCelebration();
            }
        }, 1000);
    }

    function closeCelebration() {
        clearInterval(celebrationInterval);
        clearInterval(confettiInterval);
        
        const modal = document.getElementById('celebrationModal');
        modal.classList.add('opacity-0');
        setTimeout(() => {
            modal.classList.add('hidden');
            modal.classList.remove('flex', 'opacity-0');
            openDownloadModal();
        }, 500);
    }

    // --- CAROUSEL ENGINE ---
    const videos = [
        { src: 'visual.mp4', label: 'VISUAL CONTEXT' },
        { src: 'text.mp4', label: 'CODE SYNTHESIS' },
        { src: 'audio.mp4', label: 'AUDIO INGEST' }
    ];
    let activeIndex = 0;
    
    function initCarousel() {
        const container = document.getElementById('carouselContainer');
        container.innerHTML = '';
        videos.forEach((v, i) => {
            const div = document.createElement('div');
            div.className = 'carousel-item'; 
            div.id = `c-item-${i}`;
            
            const wrapper = document.createElement('div');
            wrapper.className = "relative w-full h-full";

            const video = document.createElement('video');
            video.src = v.src; 
            video.muted = true; 
            video.playsInline = true;
            video.style.cssText = "width:100%; height:100%; object-fit:contain; background:#000;";
            
            const labelOverlay = document.createElement('div');
            labelOverlay.className = "video-label-overlay";
            labelOverlay.innerHTML = `<h3 class="text-white text-lg font-bold font-retro text-xs">${v.label}</h3><p class="text-[10px] text-neonPink uppercase tracking-widest mt-1 font-mono">Live Feed</p>`;

            wrapper.appendChild(video);
            wrapper.appendChild(labelOverlay);
            div.appendChild(wrapper);
            
            let touchTimer;
            const startTouch = () => {
                if(window.innerWidth > 768) return;
                if(div.classList.contains('item-center')){
                    touchTimer = setTimeout(() => {
                        video.classList.add('cinematic-fullscreen');
                        video.muted = false; 
                    }, 800); 
                }
            };
            const endTouch = () => {
                clearTimeout(touchTimer);
                if(video.classList.contains('cinematic-fullscreen')){
                    video.classList.remove('cinematic-fullscreen');
                    video.muted = true;
                }
            };

            div.addEventListener('touchstart', startTouch, {passive: true});
            div.addEventListener('touchend', endTouch);
            div.addEventListener('touchcancel', endTouch);

            container.appendChild(div);
        });
        updateCarousel();
    }

    function updateCarousel() {
        const total = videos.length;
        const prev = (activeIndex - 1 + total) % total;
        const next = (activeIndex + 1) % total;
        
        videos.forEach((_, i) => {
            const el = document.getElementById(`c-item-${i}`);
            const vid = el.querySelector('video');
            
            el.className = 'carousel-item transition-all duration-700 ease-[cubic-bezier(0.25,1,0.5,1)]';
            vid.classList.remove('cinematic-fullscreen');
            vid.onended = null; 
            
            if(i === activeIndex) {
                el.classList.add('item-center');
                vid.currentTime = 0;
                vid.play().catch(e => {
                    setTimeout(() => nextSlide(), 5000);
                });
                vid.style.opacity = '1';
                vid.onended = () => { nextSlide(); };
                
            } else if (i === prev) {
                el.classList.add('item-left');
                vid.pause(); vid.style.opacity = '0.3';
            } else if (i === next) {
                el.classList.add('item-right');
                vid.pause(); vid.style.opacity = '0.3';
            } else {
                el.classList.add('item-hidden');
                vid.pause();
            }
        });
        
        const label = document.getElementById('featureLabel');
        label.style.opacity = '0';
        setTimeout(() => {
            label.innerText = videos[activeIndex].label;
            label.style.opacity = '1';
        }, 300);
    }
    
    function nextSlide() {
        activeIndex = (activeIndex + 1) % videos.length; 
        updateCarousel();
    }

    // --- IDE TYPEWRITER EFFECT ---
    const codeLines = [
        { text: "class ", class: "keyword" }, { text: "Solution", class: "function" }, { text: ":\n", class: "" },
        { text: "    def ", class: "keyword" }, { text: "trap", class: "function" }, { text: "(self, height: List[int]) -> int:\n", class: "" },
        { text: "        if not ", class: "keyword" }, { text: "height: ", class: "" }, { text: "return ", class: "keyword" }, { text: "0\n", class: "number" },
        { text: "        l, r = ", class: "" }, { text: "0", class: "number" }, { text: ", len(height) - ", class: "" }, { text: "1\n", class: "number" },
        { text: "        leftMax, rightMax = height[l], height[r]\n", class: "" },
        { text: "        res = ", class: "" }, { text: "0\n", class: "number" },
        { text: "        while ", class: "keyword" }, { text: "l < r:\n", class: "" },
        { text: "            if ", class: "keyword" }, { text: "leftMax < rightMax:\n", class: "" },
        { text: "                l += ", class: "" }, { text: "1\n", class: "number" },
        { text: "                leftMax = max(leftMax, height[l])\n", class: "" },
        { text: "                res += leftMax - height[l]\n", class: "" },
        { text: "            else", class: "keyword" }, { text: ":\n", class: "" },
        { text: "                r -= ", class: "" }, { text: "1\n", class: "number" },
        { text: "                rightMax = max(rightMax, height[r])\n", class: "" },
        { text: "                res += rightMax - height[r]\n", class: "" },
        { text: "        return ", class: "keyword" }, { text: "res", class: "" }
    ];
    let currentPart = 0; let currentChar = 0;
    
    function typeCode() {
        const el = document.getElementById('code-display');
        if(!el) return; 

        if (currentPart < codeLines.length) {
            const part = codeLines[currentPart];
            let span = el.lastElementChild;
            if (currentChar === 0 || !span) {
                span = document.createElement('span');
                if (part.class) span.className = part.class;
                el.appendChild(span);
            }
            span.textContent += part.text[currentChar];
            currentChar++;
            if (currentChar >= part.text.length) {
                currentPart++;
                currentChar = 0;
            }
            setTimeout(typeCode, 15);
        } else {
            setTimeout(() => { el.innerHTML = ''; currentPart = 0; currentChar = 0; typeCode(); }, 4000);
        }
    }

    // --- DYNAMIC PLAYER COUNT ---
    function updateDynamicSignups() {
        const now = new Date();
        const istOffset = 5.5 * 60 * 60 * 1000;
        const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
        const istDate = new Date(utc + istOffset);
        let hour = istDate.getHours();
        let count = hour * hour + 942; 
        if(count === 0) count = 45; 
        
        const badge = document.getElementById('signup-badge-text');
        if(badge) badge.innerText = `System Online: ${count} Players Active`;
    }

    // --- BACKEND & AUTH ---
    const BACKEND_URL="https://whis-backend.onrender.com";
    let currentUser = null, currentCycle = 'monthly', currentTier = 'free';
    let PRICING_CONFIG = null;
    let GOOGLE_CLIENT_ID = null;

    async function fetchPricingConfig() {
        try {
            const res = await fetch(`${BACKEND_URL}/api/config`);
            if(res.ok) {
                const data = await res.json();
                PRICING_CONFIG = data.pricing;
                GOOGLE_CLIENT_ID = data.googleClientId;
                updatePricingUI();
                document.getElementById('btnPro').disabled = false;
                document.getElementById('btnElite').disabled = false;
            }
        } catch(e) { console.error("Config Error", e); }
    }

    function checkUser(){ 
        const s=localStorage.getItem('whisUser'); 
        if(s){ 
            try{ 
                currentUser=JSON.parse(s); 
                updateNavUI(currentUser); 
                fetchUserStatus(); 
            }catch(e){localStorage.removeItem('whisUser');} 
        } 
    } 
    
    function updateNavUI(u){ 
        document.getElementById('signInBtn').style.display='none'; 
        const profileTrigger = document.getElementById('userProfileTrigger');
        profileTrigger.classList.remove('hidden'); 
        profileTrigger.classList.add('flex'); 
        document.getElementById('navUserAvatar').src = u.avatarUrl; 
        document.getElementById('navUserName').innerText = u.name.split(' ')[0].toUpperCase();
    }
    
    async function handleGoogleRes(res){
        try {
            const r=await fetch(`${BACKEND_URL}/api/auth/google`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:res.credential})});
            const d=await r.json();
            if(d.success){ 
                localStorage.setItem('whisUser',JSON.stringify(d.user)); 
                currentUser=d.user; 
                updateNavUI(currentUser); 
                fetchUserStatus(); 
                closeLoginModal(); 
            }
        } catch(e){ console.error(e); }
    }
    
    function formatPrice(amount, discount) {
        if (!amount) return "...";
        if(discount > 0) {
            const discounted = Math.floor(amount * (1 - discount/100)); 
            return `<span>₹${discounted}</span> <span class="text-sm line-through text-slate-500 opacity-60 mx-1">₹${Math.floor(amount)}</span>`;
        }
        return `₹${Math.floor(amount)}`;
    }

    function setCycle(c){
        currentCycle=c;
        const btnM=document.getElementById('btnMonthly'); 
        const btnA=document.getElementById('btnAnnual');
        
        const activeClass = "px-8 py-2 rounded text-xs font-bold bg-neonBlue text-black shadow-lg uppercase transform scale-105 transition";
        const inactiveClass = "px-8 py-2 rounded text-xs font-bold text-slate-500 hover:text-white transition uppercase";

        if(c==='monthly'){
            btnM.className = activeClass;
            btnA.className = inactiveClass;
        } else {
            btnA.className = activeClass;
            btnM.className = inactiveClass;
        }
        updatePricingUI();
    }

    function updatePricingUI() {
        if (!PRICING_CONFIG) return;
        const proDiv = document.getElementById('pricePro');
        const eliteDiv = document.getElementById('priceStealth');
        
        let proPrice = 0, elitePrice = 0;
        let proDisc = PRICING_CONFIG.pro.discount;
        let eliteDisc = PRICING_CONFIG.pro_plus.discount;

        if (currentCycle === 'monthly') {
            proPrice = PRICING_CONFIG.pro.monthly;
            elitePrice = PRICING_CONFIG.pro_plus.monthly;
            proDiv.innerHTML = `${formatPrice(proPrice, proDisc)}<span class="text-[12px] text-slate-500 block font-normal mt-1 font-mono">/month</span>`;
            eliteDiv.innerHTML = `${formatPrice(elitePrice, eliteDisc)}<span class="text-[12px] text-slate-500 block font-normal mt-1 font-mono">/month</span>`;
        } else {
            proPrice = PRICING_CONFIG.pro.annual_per_month;
            elitePrice = PRICING_CONFIG.pro_plus.annual_per_month;
            proDiv.innerHTML = `${formatPrice(proPrice, proDisc)}<span class="text-[12px] text-slate-500 block font-normal mt-1 font-mono">/mo (billed yearly)</span>`;
            eliteDiv.innerHTML = `${formatPrice(elitePrice, eliteDisc)}<span class="text-[12px] text-slate-500 block font-normal mt-1 font-mono">/mo (billed yearly)</span>`;
        }
    }

    async function fetchUserStatus() {
        if(!currentUser) return;
        try {
            const r = await fetch(`${BACKEND_URL}/api/user/status`, {headers:{'x-google-id':currentUser.googleId}});
            const d = await r.json();
            if(d.active) currentTier = d.tier; else currentTier = 'free';
            
            const badge = document.getElementById('navPlanBadge');
            const validityEl = document.getElementById('modalPlanValidity');
            
            if(d.active){
                badge.innerText = d.tier === 'pro_plus' ? 'GOD MODE' : 'PRO';
                badge.className = "text-[9px] font-bold text-neonPink uppercase tracking-wide";
                
                document.getElementById('modalPlanName').innerText = d.tier === 'pro_plus' ? 'GOD MODE' : 'PRO';
                document.getElementById('modalPlanStatus').innerText = 'ACTIVE';
                
                if(d.expiry || d.validUntil) {
                    const dateStr = new Date(d.expiry || d.validUntil).toLocaleDateString();
                    validityEl.innerText = "Renews: " + dateStr;
                }
                
                const btnPro = document.getElementById('btnPro'); 
                const btnElite = document.getElementById('btnElite');
                if(d.tier === 'pro') { btnPro.innerText="Current Plan"; btnPro.disabled=true; btnElite.innerText="Upgrade to God Mode"; }
                if(d.tier === 'pro_plus') { btnPro.innerText="Included"; btnPro.disabled=true; btnElite.innerText="Current Plan"; btnElite.disabled=true; }
            } else {
                badge.innerText = 'NOOB';
                badge.className = "text-[9px] font-bold text-slate-400 uppercase tracking-wide";
            }
            document.getElementById('modalUserName').innerText = currentUser.name.toUpperCase();
            document.getElementById('modalUserAvatar').src = currentUser.avatarUrl;
        } catch(e){}
    }

    // --- PAYMENT SYSTEM ---
    let selectedTierForPayment = null; 
    const paymentModal = document.getElementById('paymentModal');

    function initiatePayment(targetTier) {
        if(!currentUser){ openLoginModal(); return; }
        if(currentTier === 'pro_plus') return;
        if(currentTier === 'pro' && targetTier === 'pro') return;
        selectedTierForPayment = targetTier;
        openPaymentModal();
    }

    function openPaymentModal() {
        paymentModal.classList.remove('hidden'); 
        paymentModal.classList.add('flex');
        document.getElementById('paypal-button-container').innerHTML = '';

        paypal.Buttons({
            style: { layout: 'vertical', color: 'blue', shape: 'rect', label: 'pay' },
            createOrder: async function(data, actions) {
                const res = await fetch(`${BACKEND_URL}/api/payment/create-paypal-order`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        googleId: currentUser.googleId, 
                        tier: selectedTierForPayment, 
                        cycle: currentCycle
                    })
                });
                const orderData = await res.json();
                return orderData.id; 
            },
            onApprove: async function(data, actions) {
                const res = await fetch(`${BACKEND_URL}/api/payment/verify-paypal`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ orderID: data.orderID, googleId: currentUser.googleId })
                });
                const details = await res.json();
                if (details.success) {
                    closePaymentModal();
                    document.getElementById('successModal').classList.remove('hidden');
                    document.getElementById('successModal').classList.add('flex');
                } else {
                    alert("PayPal Verification Failed.");
                }
            },
            onError: function (err) { alert("PayPal Error. Please try Razorpay."); }
        }).render('#paypal-button-container');
    }
