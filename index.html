<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-XXXXXXXXXX');
  </script>

  <meta charset="UTF-8" />
  <title>Whis-AI â€” Premium Interview Prep Copilot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
  <meta name="description" content="A premium desktop interview-prep copilot: practice faster, learn patterns, and walk into interviews calm and confident." />
  <meta name="theme-color" content="#050505" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['SF Pro Display', 'Inter', '-apple-system', 'system-ui', 'sans-serif'],
            mono: ['JetBrains Mono', 'Fira Code', 'ui-monospace', 'SFMono-Regular', 'monospace']
          },
          colors: {
            page: '#050505',
            glass: 'rgba(255, 255, 255, 0.035)',
            accent: 'var(--accent)',
          },
          animation: {
            'scroll': 'scroll 40s linear infinite',
            'float': 'float 8s ease-in-out infinite',
            'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'blob': 'blob 12s infinite',
            'pop-in': 'popIn 0.55s cubic-bezier(0.16, 1, 0.3, 1) forwards',
            'timer': 'timerPulse 1s linear infinite',
            'fade-up': 'fadeUp 0.7s cubic-bezier(0.16, 1, 0.3, 1) forwards',
          },
          keyframes: {
            scroll: { '0%': { transform: 'translateX(0)' }, '100%': { transform: 'translateX(-100%)' } },
            float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-10px)' } },
            blob: {
              '0%': { transform: 'translate(0px, 0px) scale(1)' },
              '33%': { transform: 'translate(26px, -46px) scale(1.08)' },
              '66%': { transform: 'translate(-18px, 18px) scale(0.92)' },
              '100%': { transform: 'translate(0px, 0px) scale(1)' },
            },
            popIn: {
              '0%': { opacity: '0', transform: 'scale(0.92) translateY(18px)' },
              '100%': { opacity: '1', transform: 'scale(1) translateY(0)' }
            },
            timerPulse: {
              '0%, 100%': { opacity: '1', transform: 'scale(1)' },
              '50%': { opacity: '0.82', transform: 'scale(0.96)' }
            },
            fadeUp: {
              '0%': { opacity: '0', transform: 'translateY(14px)' },
              '100%': { opacity: '1', transform: 'translateY(0)' }
            }
          }
        }
      }
    }
  </script>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <script src="https://www.paypal.com/sdk/js?client-id=AWt11sXML_MxwSp4shnL-JDfXlqWe_wO7d_VVCvRNT00Ws-dHCTywlD9La4aWpNNJbfz-SGuWggCNgip&currency=USD"></script>

  <style>
    /* --- PREMIUM CORE TOKENS --- */
    :root{
      --accent:#00f2ff;
      --accent-glow:rgba(0,242,255,0.35);
      --gold:#FFD700;

      --bg0:#050505;
      --bg1:#070707;
      --panel:rgba(255,255,255,0.035);
      --panel-2:rgba(255,255,255,0.05);
      --stroke:rgba(255,255,255,0.08);
      --stroke-2:rgba(255,255,255,0.12);
      --text:#e2e8f0;
      --muted:rgba(226,232,240,0.72);
      --muted2:rgba(226,232,240,0.5);

      --r-lg:28px;
      --r-md:20px;
      --shadow-soft: 0 20px 60px rgba(0,0,0,0.55);
      --shadow-tight: 0 14px 38px rgba(0,0,0,0.55);
    }

    @property --accent { syntax:'<color>'; initial-value:#00f2ff; inherits:true; }

    html { scroll-behavior:smooth; -webkit-overflow-scrolling:touch; }
    body{
      background: radial-gradient(1200px 700px at 30% -10%, rgba(255,255,255,0.05), transparent 60%),
                  radial-gradient(900px 500px at 100% 20%, rgba(255,255,255,0.03), transparent 55%),
                  var(--bg0);
      color:var(--text);
      font-family:'Inter',sans-serif;
      overflow-x:hidden;
      padding-bottom: calc(96px + env(safe-area-inset-bottom));
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
      animation: colorCycle 60s linear infinite;
    }

    p{ font-size:16px; line-height:1.65; }
    @media (min-width:768px){ p{ font-size:18px; } }

    *{ backface-visibility:hidden; -webkit-backface-visibility:hidden; }

    @keyframes colorCycle{
      0%{ --accent:#00f2ff; --accent-glow:rgba(0,242,255,0.30); }
      33%{ --accent:#8b5cf6; --accent-glow:rgba(139,92,246,0.28); }
      66%{ --accent:#10b981; --accent-glow:rgba(16,185,129,0.28); }
      100%{ --accent:#00f2ff; --accent-glow:rgba(0,242,255,0.30); }
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      *{ animation-duration: 0.001ms !important; animation-iteration-count:1 !important; transition-duration:0.001ms !important; scroll-behavior:auto !important; }
    }

    /* Focus */
    :focus-visible{
      outline: 2px solid rgba(255,255,255,0.25);
      outline-offset: 3px;
      border-radius: 12px;
    }

    /* --- UTILITIES --- */
    .text-accent{ color:var(--accent); transition:color 1.5s; }
    .bg-accent{ background-color:var(--accent); transition:background-color 1.5s; }
    .border-accent{ border-color:var(--accent); transition:border-color 1.5s; }
    .shadow-accent{ box-shadow: 0 0 34px var(--accent-glow); transition: box-shadow 1.5s; }

    .glass-panel{
      background: linear-gradient(180deg, rgba(255,255,255,0.055), rgba(255,255,255,0.02));
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      border: 1px solid rgba(255,255,255,0.07);
      box-shadow: 0 18px 55px rgba(0,0,0,0.55);
    }

    /* --- PHYSICS CARD (premium depth) --- */
    .physics-card{
      background: linear-gradient(180deg, rgba(18,18,18,0.62) 0%, rgba(10,10,10,0.88) 100%);
      backdrop-filter: blur(22px);
      -webkit-backdrop-filter: blur(22px);
      border: 1px solid var(--stroke);
      border-radius: var(--r-lg);
      position: relative;
      overflow: hidden;
      transition: transform .18s ease, border-color .45s ease, box-shadow .45s ease;
      will-change: transform;
      box-shadow: var(--shadow-tight);
    }
    .physics-card::before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(700px circle at var(--mouse-x) var(--mouse-y), rgba(255,255,255,0.08), transparent 42%),
        radial-gradient(900px circle at 25% 0%, rgba(255,255,255,0.05), transparent 55%);
      opacity:0;
      transition: opacity .5s;
      pointer-events:none;
      z-index:2;
    }
    .physics-card:hover::before{ opacity:1; }
    .physics-card:hover{
      border-color: rgba(255,255,255,0.18);
      transform: translateY(-2px);
      box-shadow: 0 28px 80px rgba(0,0,0,0.62);
    }

    /* --- INTRO --- */
    .intro-overlay{
      position:fixed; inset:0; z-index:9999;
      background:
        radial-gradient(900px 500px at 50% 25%, rgba(255,255,255,0.06), transparent 60%),
        #000;
      display:flex; align-items:center; justify-content:center;
      pointer-events:none;
      transition: opacity .85s ease-out;
    }
    .intro-text{
      font-size: 2.5rem;
      font-weight: 300;
      letter-spacing: -0.03em;
      background: linear-gradient(to bottom, #fff, rgba(255,255,255,0.45));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      opacity:0;
      transform: translateY(10px) scale(0.98);
      transition: all .85s cubic-bezier(0.16, 1, 0.3, 1);
      text-align:center;
      max-width: 16ch;
      line-height: 1.05;
    }
    .intro-active{ opacity:1; transform: translateY(0) scale(1); }

    /* --- CAROUSEL --- */
    .carousel-container{
      perspective: 1000px;
      display:flex; justify-content:center; align-items:center;
      height: 260px;
      position:relative;
      margin: 18px 0 0;
      transform: translateZ(0);
    }
    @media (min-width:768px){ .carousel-container{ height: 620px; margin: 0; } }

    .carousel-item{
      position:absolute;
      width: 92%;
      aspect-ratio: 16/9;
      transition: all .78s cubic-bezier(0.2, 0.8, 0.2, 1);
      border-radius: 18px;
      overflow:hidden;
      background:#000;
      border: 1px solid rgba(255,255,255,0.10);
      box-shadow: 0 26px 70px rgba(0,0,0,0.75);
      will-change: transform, opacity;
    }
    @media (min-width:768px){ .carousel-item{ width: 80%; border-radius: 22px; } }

    .item-center{
      z-index:30;
      transform: translate3d(0,0,0) scale(1);
      opacity:1;
      border-color: var(--accent);
      box-shadow: 0 0 70px var(--accent-glow), 0 26px 70px rgba(0,0,0,0.75);
    }
    .item-left{ z-index:10; transform: translate3d(-10%, 0, -100px) scale(0.86); opacity:0.28; }
    .item-right{ z-index:10; transform: translate3d(10%, 0, -100px) scale(0.86); opacity:0.28; }
    @media (min-width:768px){
      .item-left{ transform: translate3d(-50%, 0, -200px) rotateY(15deg) scale(0.86); }
      .item-right{ transform: translate3d(50%, 0, -200px) rotateY(-15deg) scale(0.86); }
    }
    .item-hidden{ z-index:0; opacity:0; transform: scale(0.55); }

    .video-label-overlay{
      position:absolute; left:0; right:0; bottom:0;
      background: linear-gradient(to top, rgba(0,0,0,0.92), rgba(0,0,0,0.25), transparent);
      padding: 18px 18px 16px;
      opacity:0;
      transition: opacity .5s;
      z-index: 5;
    }
    .item-center .video-label-overlay{ opacity:1; }

    .cinematic-fullscreen{
      position: fixed !important;
      top:0; left:0; right:0; bottom:0;
      width:100vw !important;
      height:100vh !important;
      transform:none !important;
      z-index: 9999 !important;
      border-radius: 0 !important;
      border:none !important;
      object-fit: contain;
      background:black;
    }

    /* --- CODE --- */
    pre { white-space: pre-wrap; margin: 0; font-family: 'JetBrains Mono', monospace; overflow-x: hidden; }
    .keyword{ color:#c678dd; } .function{ color:#61afef; } .string{ color:#98c379; } .number{ color:#d19a66; }

    /* Scrollbar */
    .no-scrollbar::-webkit-scrollbar { display:none; }
    .no-scrollbar { -ms-overflow-style:none; scrollbar-width:none; }

    /* Pricing elite border */
    .pricing-elite{ position:relative; overflow:hidden; }
    .pricing-elite::after{
      content:'';
      position:absolute; inset:0;
      border-radius: var(--r-lg);
      padding:2px;
      background: linear-gradient(180deg, var(--accent), transparent 78%);
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor; mask-composite: exclude;
      pointer-events:none;
    }

    /* FAQ */
    .faq-content{ max-height:0; overflow:hidden; transition:max-height .32s ease-out; }
    .faq-active .faq-content{ max-height: 320px; }
    .faq-active i{ transform: rotate(180deg); }

    .snap-center{ scroll-snap-align:center; }

    /* Celebration */
    .celebration-bg{ background: radial-gradient(circle at center, #151100 0%, #000 70%); }
    .celebration-glow{ text-shadow: 0 0 20px rgba(255,215,0,0.75), 0 0 42px rgba(255,215,0,0.55); }
    .shine-button{ position:relative; overflow:hidden; }
    .shine-button::after{
      content:'';
      position:absolute; top:0; left:-120%;
      width: 120%; height:100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.42), transparent);
      animation: shine 2.1s infinite;
    }
    @keyframes shine{ 100%{ left: 120%; } }

    /* Nav scrolled */
    .nav-scrolled{
      background: rgba(0,0,0,0.78) !important;
      border-bottom: 1px solid rgba(255,255,255,0.08) !important;
      box-shadow: 0 18px 60px rgba(0,0,0,0.55);
    }

    /* Mobile CTA safe-area */
    .mobile-cta{
      padding-bottom: calc(18px + env(safe-area-inset-bottom));
    }
  </style>
</head>

<body>
  <div id="intro-layer" class="intro-overlay" aria-hidden="true">
    <h1 id="intro-text" class="intro-text">
      Walk In Calm.<br>
      <span class="text-accent text-3xl md:text-5xl mt-4 block">Welcome to Whis-AI</span>
    </h1>
  </div>

  <div class="fixed inset-0 z-0 pointer-events-none overflow-hidden">
    <div class="absolute top-[-22%] left-[-12%] w-[70vw] h-[70vh] bg-[var(--accent)] rounded-full blur-[130px] opacity-[0.07] animate-blob"></div>
    <div class="absolute bottom-[-22%] right-[-12%] w-[60vw] h-[60vh] bg-blue-900 rounded-full blur-[130px] opacity-[0.09] animate-blob" style="animation-delay: 2.2s"></div>
    <div class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-[0.03] mix-blend-overlay"></div>
  </div>

  <!-- CELEBRATION MODAL (feature preserved) -->
  <div id="celebrationModal" class="fixed inset-0 z-[1000] hidden items-center justify-center celebration-bg backdrop-blur-xl transition-opacity duration-500" role="dialog" aria-modal="true" aria-label="Welcome offer">
    <button onclick="closeCelebration()" class="absolute top-6 right-6 text-white/50 hover:text-white transition transform hover:scale-110 z-50" aria-label="Close">
      <i class="fa-solid fa-xmark text-3xl"></i>
    </button>

    <div class="absolute inset-0 overflow-hidden pointer-events-none">
      <div class="absolute top-0 left-1/4 w-96 h-96 bg-yellow-500/10 rounded-full blur-[110px] animate-pulse"></div>
      <div class="absolute bottom-0 right-1/4 w-96 h-96 bg-purple-500/10 rounded-full blur-[110px] animate-pulse" style="animation-delay: 1s"></div>
    </div>

    <div class="relative z-10 text-center p-6 max-w-xl w-full transform scale-0 animate-pop-in flex flex-col items-center">
      <div class="w-20 h-20 mb-8 rounded-full border-2 border-yellow-500/30 flex items-center justify-center relative bg-black/40 backdrop-blur-md animate-timer">
        <span id="countdownTimer" class="text-3xl font-mono font-bold text-yellow-400">10</span>
        <svg class="absolute inset-0 w-full h-full -rotate-90 pointer-events-none" viewBox="0 0 36 36">
          <path class="text-yellow-500/20" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="currentColor" stroke-width="2"/>
        </svg>
      </div>

      <div class="w-24 h-24 mx-auto mb-6 bg-yellow-500/10 rounded-full flex items-center justify-center border border-yellow-500/50 shadow-[0_0_70px_rgba(255,215,0,0.18)]">
        <i class="fa-solid fa-gift text-5xl text-yellow-400 animate-bounce"></i>
      </div>

      <h2 class="text-4xl md:text-6xl font-black text-white mb-2 celebration-glow uppercase italic tracking-tighter">Welcome Bonus</h2>
      <p class="text-lg md:text-2xl text-yellow-200 font-bold mb-6 tracking-wide">You Unlocked 3 Free Sessions</p>

      <div class="bg-white/5 border border-white/10 rounded-xl p-5 mb-8 backdrop-blur-md w-full">
        <p class="text-slate-300 text-sm leading-relaxed">
          Your account has been granted a <span class="text-yellow-400 font-bold">Starter Boost</span>.
          Use your free sessions to practice with real interview-style prompts and get instant feedback.
        </p>
      </div>

      <button onclick="closeCelebration()" class="shine-button w-full py-5 rounded-2xl bg-gradient-to-r from-yellow-400 to-yellow-600 text-black text-lg font-black uppercase tracking-widest shadow-[0_0_44px_rgba(255,215,0,0.26)] hover:scale-105 transition duration-300">
        Claim & Continue
      </button>
    </div>
  </div>

  <!-- NAV -->
  <nav id="topNav" class="fixed top-0 w-full z-50 h-[72px] flex items-center justify-center bg-black/55 backdrop-blur-xl border-b border-white/5 transition-all duration-300">
    <div class="w-full max-w-7xl px-6 flex items-center justify-between">
      <a href="/" class="flex items-center gap-3 group" aria-label="Whis-AI home">
        <div class="w-9 h-9 rounded-xl bg-white/5 border border-white/10 flex items-center justify-center group-hover:border-accent/50 transition">
          <i class="fa-solid fa-bolt text-accent text-sm"></i>
        </div>
        <span class="text-lg font-bold tracking-tight text-white group-hover:text-accent transition">Whis-AI</span>
      </a>

      <div class="hidden md:flex items-center gap-1 bg-white/5 p-1 rounded-full border border-white/5 backdrop-blur-md">
        <a href="#features" class="px-5 py-1.5 text-xs font-medium text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition">Features</a>
        <a href="#demo" class="px-5 py-1.5 text-xs font-medium text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition">How it Works</a>
        <a href="#pricing" class="px-5 py-1.5 text-xs font-medium text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition">Pricing</a>
      </div>

      <div class="flex items-center gap-4">
        <button onclick="openLoginModal()" id="signInBtn" class="text-xs font-medium text-slate-400 hover:text-white transition px-2">Sign In</button>

        <button onclick="openDownloadModal()" class="hidden md:flex items-center gap-2 group relative px-5 py-2 rounded-full bg-white text-black text-xs font-bold overflow-hidden shadow-[0_0_22px_rgba(255,255,255,0.14)] hover:shadow-accent/40 transition duration-500">
          <span class="relative z-10">Get 3 Free Sessions</span>
          <div class="absolute inset-0 bg-accent opacity-0 group-hover:opacity-100 transition duration-500"></div>
        </button>

        <button onclick="openProfileModal()" id="userProfileTrigger" class="hidden items-center gap-3 bg-white/5 pr-4 pl-1 py-1 rounded-full border border-white/10 hover:border-white/30 transition">
          <img id="navUserAvatar" src="" class="w-7 h-7 rounded-full bg-slate-800 object-cover" />
          <span id="navPlanBadge" class="text-[9px] font-bold text-slate-400 uppercase tracking-wide">FREE</span>
        </button>
      </div>
    </div>
  </nav>

  <!-- MOBILE BOTTOM CTA -->
  <div class="md:hidden fixed bottom-0 left-0 right-0 z-50 bg-black/88 backdrop-blur-xl border-t border-accent/20 p-4 mobile-cta flex flex-col gap-2 shadow-[0_-14px_55px_rgba(0,0,0,0.78)]">
    <div class="text-[10px] text-center text-accent uppercase tracking-widest font-bold mb-1 animate-pulse">âš¡ Live: practice sessions running now</div>
    <button onclick="openDownloadModal()" class="w-full py-3.5 rounded-xl bg-accent text-black text-sm font-extrabold text-center shadow-[0_0_18px_var(--accent-glow)] uppercase tracking-wide active:scale-[0.99]">
      Start Free Practice
    </button>
    <div class="text-[10px] text-center text-slate-500 font-mono uppercase tracking-widest">Mac & Windows â€¢ No credit card</div>
  </div>

  <!-- WHATSAPP (feature preserved) -->
  <a href="https://wa.me/9092435258" target="_blank" class="fixed bottom-28 right-4 z-40 bg-[#25D366] w-12 h-12 rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition md:bottom-8 group" aria-label="WhatsApp support">
    <i class="fa-brands fa-whatsapp text-white text-2xl"></i>
    <span class="absolute right-14 bg-black/80 border border-white/10 text-white text-[10px] font-bold py-1 px-3 rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition duration-300 pointer-events-none">24/7 Support</span>
  </a>

  <!-- HERO -->
  <section class="relative pt-24 md:pt-48 pb-12 flex flex-col items-center overflow-hidden">
    <div class="relative z-10 text-center max-w-6xl px-6 mb-2 flex flex-col items-center">
      <div class="mb-6 md:mb-8 inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-white/5 border border-white/10 text-[10px] font-bold text-slate-300 backdrop-blur-md shadow-lg">
        <span class="relative flex h-2 w-2">
          <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
          <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span>
        </span>
        <span id="signup-badge-text">ðŸ”¥ 150+ candidates practicing now</span>
      </div>

      <h1 class="text-4xl md:text-8xl font-medium tracking-tight leading-[1] mb-6 md:mb-8 text-white">
        Never Freeze In An<br>
        <span class="text-accent drop-shadow-[0_0_42px_var(--accent-glow)]">Interview Again.</span>
      </h1>

      <p class="text-base md:text-xl text-slate-400 max-w-2xl mx-auto mb-8 md:mb-10 leading-relaxed font-light px-2">
        Your premium interview-prep copilot. Practice with realistic prompts, learn patterns, and turn pressure into clarity.
        <span class="text-white font-medium block mt-2">Fast. Calm. Confident.</span>
      </p>

      <div class="flex flex-col items-center gap-5 w-full md:w-auto">
        <div class="bg-gradient-to-r from-yellow-500/10 to-transparent border border-yellow-500/20 px-5 py-2 rounded-full flex items-center gap-2">
          <i class="fa-solid fa-crown text-[#FFD700] text-xs"></i>
          <span class="text-[#FFD700] text-[10px] font-bold tracking-widest uppercase">Limited Offer: 3 Free Sessions</span>
        </div>

        <button id="heroDownloadBtn" onclick="openDownloadModal()" class="group w-full md:w-auto px-12 py-5 rounded-2xl bg-white text-black text-sm font-bold hover:scale-105 transition duration-300 shadow-[0_0_44px_rgba(255,255,255,0.14)] flex justify-center items-center gap-3 active:scale-[0.99]">
          <div class="flex items-center gap-3 border-r border-black/10 pr-3 mr-1">
            <i class="fa-brands fa-apple text-xl"></i>
            <i class="fa-brands fa-windows text-xl"></i>
          </div>
          Download & Start Practicing
        </button>
      </div>

      <div class="flex flex-wrap justify-center gap-4 md:gap-6 mt-8 text-[11px] text-slate-500 font-mono uppercase tracking-wider">
        <span class="flex items-center gap-2"><i class="fa-solid fa-check text-accent"></i> No Credit Card</span>
        <span class="flex items-center gap-2"><i class="fa-solid fa-check text-accent"></i> Desktop App</span>
        <span class="flex items-center gap-2"><i class="fa-solid fa-check text-accent"></i> Mac & Windows</span>
      </div>
    </div>

    <div class="w-full max-w-7xl mx-auto mt-8 md:mt-12 mb-12 md:mb-20 relative scroller-mask px-6 opacity-40 z-30">
      <div class="flex overflow-hidden group">
        <div class="flex gap-16 animate-scroll group-hover:[animation-play-state:paused] items-center text-white/50 hover:text-white transition duration-500">
          <i class="fa-brands fa-google text-3xl"></i><i class="fa-brands fa-meta text-3xl"></i><i class="fa-brands fa-amazon text-3xl"></i>
          <i class="fa-brands fa-apple text-3xl"></i><i class="fa-brands fa-uber text-3xl"></i><i class="fa-brands fa-microsoft text-3xl"></i>
          <i class="fa-brands fa-stripe text-3xl"></i><i class="fa-brands fa-airbnb text-3xl"></i><i class="fa-brands fa-tiktok text-3xl"></i>
          <i class="fa-brands fa-google text-3xl"></i><i class="fa-brands fa-meta text-3xl"></i>
        </div>
      </div>
    </div>

    <div class="w-full relative z-20">
      <div class="carousel-container" id="carouselContainer"></div>
      <div class="text-center mt-6">
        <p id="featureLabel" class="text-[10px] font-mono text-accent uppercase tracking-[0.4em] animate-pulse">SYSTEM INITIALIZED</p>
        <div class="md:hidden mt-3 flex items-center justify-center gap-2">
          <i class="fa-solid fa-fingerprint text-slate-500 text-xs"></i>
          <p class="text-[10px] text-slate-500 uppercase tracking-wide">Press & Hold video to expand</p>
        </div>
      </div>
    </div>
  </section>

  <!-- DEMO -->
  <section id="demo" class="py-16 md:py-24 border-t border-white/5 bg-black/40 relative">
    <div class="absolute top-0 inset-x-0 h-px bg-gradient-to-r from-transparent via-accent/50 to-transparent"></div>

    <div class="max-w-7xl mx-auto px-6">
      <div class="grid lg:grid-cols-2 gap-10 md:gap-16 items-center">
        <div class="space-y-6 md:space-y-8">
          <h2 class="text-3xl md:text-6xl font-medium text-white tracking-tight">
            Real-time<br><span class="text-slate-500">Practice Engine.</span>
          </h2>
          <p class="text-slate-400 text-base md:text-lg font-light leading-relaxed">
            Whis helps you rehearse: it listens to questions, captures context, and guides you toward strong solutionsâ€”so you build speed and confidence before the real interview.
          </p>

          <div class="physics-card p-6 md:p-8 bg-[#0a0a0a]">
            <div class="flex items-center gap-4 mb-6">
              <div class="flex h-3 w-3 relative">
                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500"></span>
              </div>
              <span class="text-[10px] font-mono text-white/50 uppercase tracking-widest">Session Running</span>
            </div>
            <div class="flex items-center gap-1 h-12 opacity-80">
              <div class="w-1 bg-white rounded-full h-4 animate-pulse"></div>
              <div class="w-1 bg-white rounded-full h-8 animate-pulse" style="animation-delay: 0.1s"></div>
              <div class="w-1 bg-white rounded-full h-12 animate-pulse" style="animation-delay: 0.2s"></div>
              <div class="w-1 bg-white rounded-full h-6 animate-pulse" style="animation-delay: 0.15s"></div>
              <div class="w-1 bg-white rounded-full h-10 animate-pulse" style="animation-delay: 0.3s"></div>
              <div class="w-1 bg-white rounded-full h-5 animate-pulse" style="animation-delay: 0.1s"></div>
              <div class="w-1 bg-white rounded-full h-12 animate-pulse" style="animation-delay: 0.4s"></div>
              <div class="w-1 bg-white rounded-full h-4 animate-pulse"></div>
            </div>
            <p class="mt-6 text-sm text-slate-400 italic border-l-2 border-accent pl-4">"Letâ€™s reduce this to O(n) with a sliding window and prove it with invariantsâ€¦"</p>
          </div>
        </div>

        <div class="physics-card p-0 bg-[#0d0d0d] border border-white/10 h-[400px] md:h-[500px] flex flex-col shadow-2xl shadow-black/50">
          <div class="px-4 py-3 border-b border-white/5 flex justify-between items-center bg-white/5">
            <div class="flex gap-2">
              <div class="w-3 h-3 rounded-full bg-red-500/20"></div>
              <div class="w-3 h-3 rounded-full bg-yellow-500/20"></div>
              <div class="w-3 h-3 rounded-full bg-green-500/20"></div>
            </div>
            <div class="text-[10px] font-mono font-bold text-slate-500 flex gap-4">
              <span class="text-accent">main.py</span>
              <span>Solution.cpp</span>
              <span>Service.java</span>
            </div>
          </div>
          <div class="p-4 md:p-6 flex-grow overflow-x-auto relative no-scrollbar">
            <pre id="code-display" class="text-xs md:text-sm leading-relaxed text-slate-300 font-mono"></pre>
            <span id="cursor" class="absolute w-2 h-5 bg-accent animate-pulse inline-block align-middle ml-1"></span>
          </div>
          <div class="px-4 py-2 border-t border-white/5 text-[10px] text-green-400 font-mono bg-green-900/10 flex justify-between">
            <span><i class="fa-solid fa-circle-check"></i> Practice Tests: 14/14 Passed</span>
            <span>Runtime: 32ms (Beats 98%)</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- TRUST / ETHOS (repositioned to legit) -->
  <section class="py-16 md:py-24 border-t border-white/5 bg-black relative overflow-hidden">
    <div class="max-w-5xl mx-auto px-6 text-center relative z-10">
      <div class="inline-block p-1 rounded-full border border-accent/30 bg-accent/5 px-4 mb-6 backdrop-blur">
        <span class="text-xs font-bold text-accent">ðŸ§  Built for Real Skill</span>
      </div>
      <h2 class="text-3xl md:text-5xl font-medium text-white mb-8 md:mb-12">
        Practice privately.<br>You perform publicly.
      </h2>

      <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto mb-12">
        <div class="group relative">
          <div class="absolute -inset-1 bg-gradient-to-r from-slate-600 to-slate-900 rounded-2xl blur opacity-20 group-hover:opacity-40 transition duration-1000"></div>
          <div class="bg-[#0f0f0f] p-6 rounded-xl border border-white/10 relative h-full">
            <div class="flex justify-between items-center mb-4">
              <p class="text-[10px] text-slate-500 uppercase font-bold tracking-widest">Your Practice Setup</p>
              <i class="fa-solid fa-laptop-code text-slate-700"></i>
            </div>
            <div class="aspect-video bg-[#1a1a1a] rounded-lg flex items-center justify-center border border-white/5">
              <i class="fa-solid fa-terminal text-slate-600 text-4xl"></i>
            </div>
            <p class="text-xs text-slate-400 mt-4 text-left">
              Use Whis to rehearse: prompt â†’ approach â†’ code â†’ verification. Build muscle memory and reduce interview stress.
            </p>
          </div>
        </div>

        <div class="group relative">
          <div class="absolute -inset-1 bg-gradient-to-r from-cyan-400 to-blue-600 rounded-2xl blur opacity-25 group-hover:opacity-55 transition duration-1000"></div>
          <div class="bg-[#0f0f0f] p-6 rounded-xl border border-accent/25 relative h-full">
            <div class="flex justify-between items-center mb-4">
              <p class="text-[10px] text-accent uppercase font-bold tracking-widest">Your Outcome</p>
              <i class="fa-solid fa-award text-accent"></i>
            </div>
            <div class="aspect-video bg-[#1a1a1a] rounded-lg flex items-center justify-center relative overflow-hidden border border-white/5">
              <div class="text-center">
                <div class="text-white font-bold text-lg">Clarity + Speed</div>
                <div class="text-slate-500 text-xs mt-1">Structure â€¢ Edge cases â€¢ Confidence</div>
              </div>
            </div>
            <p class="text-xs text-white mt-4 text-left">
              Learn patterns, communicate cleanly, and stay composedâ€”so your actual interview performance improves.
            </p>
          </div>
        </div>
      </div>

      <div class="flex flex-wrap justify-center gap-6 md:gap-8 text-xs text-slate-500 font-mono">
        <span class="flex items-center gap-2"><i class="fa-solid fa-shield-halved"></i> No browser extensions</span>
        <span class="flex items-center gap-2"><i class="fa-solid fa-bolt"></i> Low-latency desktop app</span>
        <span class="flex items-center gap-2"><i class="fa-solid fa-brain"></i> Pattern-based learning</span>
      </div>
    </div>
  </section>

  <!-- FEATURES -->
  <section id="features" class="py-16 md:py-32 border-t border-white/5 bg-[#050505]">
    <div class="max-w-7xl mx-auto px-6">
      <h2 class="text-3xl font-medium text-white mb-12 md:mb-16 text-center">The Advantage.</h2>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6">
        <div class="physics-card p-6 md:p-8 hover:bg-white/5 transition group">
          <div class="w-12 h-12 rounded-lg bg-purple-500/10 flex items-center justify-center mb-6 group-hover:scale-110 transition">
            <i class="fa-solid fa-layer-group text-xl text-purple-400"></i>
          </div>
          <h3 class="text-white font-bold mb-2">Structured Thinking</h3>
          <p class="text-sm text-slate-400 leading-relaxed">Turn messy prompts into clean steps: constraints â†’ approach â†’ complexity â†’ edge cases.</p>
        </div>

        <div class="physics-card p-6 md:p-8 hover:bg-white/5 transition group">
          <div class="w-12 h-12 rounded-lg bg-blue-500/10 flex items-center justify-center mb-6 group-hover:scale-110 transition">
            <i class="fa-solid fa-eye text-xl text-blue-400"></i>
          </div>
          <h3 class="text-white font-bold mb-2">Visual Context</h3>
          <p class="text-sm text-slate-400 leading-relaxed">Practice with whiteboards, diagrams, and architecturesâ€”get guidance on what matters.</p>
        </div>

        <div class="physics-card p-6 md:p-8 hover:bg-white/5 transition group">
          <div class="w-12 h-12 rounded-lg bg-red-500/10 flex items-center justify-center mb-6 group-hover:scale-110 transition">
            <i class="fa-solid fa-microphone text-xl text-red-400"></i>
          </div>
          <h3 class="text-white font-bold mb-2">Voice Input</h3>
          <p class="text-sm text-slate-400 leading-relaxed">Hear a question and instantly practice a crisp response with better structure and phrasing.</p>
        </div>

        <div class="physics-card p-6 md:p-8 hover:bg-white/5 transition group">
          <div class="w-12 h-12 rounded-lg bg-yellow-500/10 flex items-center justify-center mb-6 group-hover:scale-110 transition">
            <i class="fa-solid fa-language text-xl text-yellow-400"></i>
          </div>
          <h3 class="text-white font-bold mb-2">Polyglot Mode</h3>
          <p class="text-sm text-slate-400 leading-relaxed">Translate questions and practice solutions across languages with consistent technical clarity.</p>
        </div>

        <div class="physics-card p-6 md:p-8 hover:bg-white/5 transition group">
          <div class="w-12 h-12 rounded-lg bg-green-500/10 flex items-center justify-center mb-6 group-hover:scale-110 transition">
            <i class="fa-solid fa-keyboard text-xl text-green-400"></i>
          </div>
          <h3 class="text-white font-bold mb-2">Direct Input</h3>
          <p class="text-sm text-slate-400 leading-relaxed">Ask follow-up questions mid-practice without breaking flowâ€”fast iteration wins interviews.</p>
        </div>

        <div class="physics-card p-6 md:p-8 hover:bg-white/5 transition group">
          <div class="w-12 h-12 rounded-lg bg-slate-500/10 flex items-center justify-center mb-6 group-hover:scale-110 transition">
            <i class="fa-solid fa-bolt text-xl text-white"></i>
          </div>
          <h3 class="text-white font-bold mb-2">Low Latency</h3>
          <p class="text-sm text-slate-400 leading-relaxed">Built as a native desktop experience for smooth, instant practice feedback.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- OUTCOMES -->
  <section class="py-16 md:py-24 border-t border-white/5 bg-[#080808]">
    <div class="max-w-7xl mx-auto px-6 mb-8 md:mb-12 flex justify-between items-end">
      <h2 class="text-2xl md:text-3xl font-medium text-white">User Outcomes.</h2>
      <div class="flex gap-2">
        <button class="w-10 h-10 rounded-full border border-white/10 flex items-center justify-center hover:bg-white/10 transition" aria-label="Previous testimonial"><i class="fa-solid fa-arrow-left text-white"></i></button>
        <button class="w-10 h-10 rounded-full border border-white/10 flex items-center justify-center hover:bg-white/10 transition" aria-label="Next testimonial"><i class="fa-solid fa-arrow-right text-white"></i></button>
      </div>
    </div>

    <div class="flex gap-6 overflow-x-auto pb-12 px-6 snap-x mandatory no-scrollbar" style="-webkit-overflow-scrolling: touch;">
      <div class="physics-card p-6 md:p-8 min-w-[300px] md:min-w-[400px] snap-center bg-[#0a0a0a]">
        <div class="flex gap-1 text-accent text-xs mb-6"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i></div>
        <p class="text-sm text-slate-300 leading-relaxed mb-6 font-light">"I stopped blanking out. The practice flow helped me explain tradeoffs clearly and code faster under pressure."</p>
        <div class="flex items-center gap-3 border-t border-white/5 pt-4">
          <div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-xs font-bold text-white">J</div>
          <div><p class="text-xs font-bold text-white">James K.</p><p class="text-[10px] text-slate-500">SWE</p></div>
        </div>
      </div>

      <div class="physics-card p-6 md:p-8 min-w-[300px] md:min-w-[400px] snap-center bg-[#0a0a0a]">
        <div class="flex gap-1 text-accent text-xs mb-6"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i></div>
        <p class="text-sm text-slate-300 leading-relaxed mb-6 font-light">"The biggest change was structure: assumptions, edge cases, and complexity. Interviews felt controllable."</p>
        <div class="flex items-center gap-3 border-t border-white/5 pt-4">
          <div class="w-8 h-8 rounded-full bg-orange-500 flex items-center justify-center text-xs font-bold text-white">S</div>
          <div><p class="text-xs font-bold text-white">Sarah M.</p><p class="text-[10px] text-slate-500">SDE</p></div>
        </div>
      </div>

      <div class="physics-card p-6 md:p-8 min-w-[300px] md:min-w-[400px] snap-center bg-[#0a0a0a]">
        <div class="flex gap-1 text-accent text-xs mb-6"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i></div>
        <p class="text-sm text-slate-300 leading-relaxed mb-6 font-light">"English isn't my first language. Practicing answers with better phrasing boosted my confidence massively."</p>
        <div class="flex items-center gap-3 border-t border-white/5 pt-4">
          <div class="w-8 h-8 rounded-full bg-green-500 flex items-center justify-center text-xs font-bold text-white">M</div>
          <div><p class="text-xs font-bold text-white">Michael T.</p><p class="text-[10px] text-slate-500">Engineer</p></div>
        </div>
      </div>
    </div>
  </section>

  <!-- PRICING (logic preserved) -->
  <section id="pricing" class="py-16 md:py-32 border-t border-white/5 relative">
    <div class="max-w-7xl mx-auto px-6 text-center">
      <div class="mb-12 max-w-3xl mx-auto">
        <h2 class="text-3xl md:text-5xl font-medium text-white mb-6">Invest In Your Career.</h2>
        <div class="p-4 rounded-2xl bg-gradient-to-r from-accent/5 to-transparent border-l-2 border-accent text-left">
          <p class="text-slate-200 text-sm md:text-lg italic font-light">
            "Weâ€™re here to help you build real skillâ€”faster. <span class="text-accent not-italic font-bold">Practice smart. Perform strong.</span>"
          </p>
        </div>
      </div>

      <div class="inline-flex bg-white/5 p-1 rounded-xl border border-white/10 mb-12 relative">
        <button id="btnMonthly" class="px-8 py-2.5 rounded-lg text-xs font-bold bg-white text-black transition shadow-lg" onclick="setCycle('monthly')">Monthly</button>
        <button id="btnAnnual" class="px-8 py-2.5 rounded-lg text-xs font-bold text-slate-500 hover:text-white transition" onclick="setCycle('annual')">Yearly (-20%)</button>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8 max-w-6xl mx-auto items-stretch">
        <div class="physics-card p-6 md:p-8 text-left flex flex-col h-full border-accent/40 shadow-[0_0_30px_rgba(0,242,255,0.05)] relative group">
          <div class="absolute top-0 right-0 bg-accent text-black text-[10px] font-bold px-4 py-1.5 rounded-bl-xl uppercase tracking-wider">Start Here</div>
          <h3 class="text-xs font-bold text-accent uppercase tracking-widest mb-4">Starter</h3>
          <div class="text-4xl md:text-5xl font-bold text-white mb-2">Free</div>
          <p class="text-xs text-slate-400 mb-8">No credit card needed</p>
          <div class="space-y-4 text-xs text-slate-400 mb-8 flex-grow">
            <div class="flex gap-3 font-bold text-white bg-white/5 p-3 rounded-lg border border-accent/20">
              <i class="fa-solid fa-crown text-[#FFD700] mt-0.5"></i>
              <div>
                3 FREE SESSIONS
                <p class="font-normal text-[10px] text-slate-400 mt-1 opacity-80">Practice end-to-end with premium guidance.</p>
              </div>
            </div>
            <p class="flex gap-3"><i class="fa-solid fa-check text-white"></i> 10 Daily Syntheses (Forever)</p>
            <p class="flex gap-3"><i class="fa-solid fa-check text-white"></i> Basic Code Guidance</p>
          </div>
          <button onclick="openDownloadModal()" class="w-full py-4 rounded-xl bg-white text-black hover:scale-105 transition duration-300 text-xs font-bold uppercase shadow-lg group-hover:shadow-accent/20 active:scale-[0.99]">Download Now</button>
        </div>

        <div class="physics-card p-6 md:p-8 text-left flex flex-col h-full border-white/10 hover:border-white/20">
          <h3 class="text-xs font-bold text-slate-300 uppercase tracking-widest mb-4">Pro License</h3>
          <div class="text-4xl md:text-5xl font-bold text-white mb-6" id="pricePro">...</div>
          <div class="space-y-4 text-xs text-slate-300 mb-8 flex-grow">
            <p class="flex gap-3"><i class="fa-solid fa-check text-white"></i> Unlimited Syntheses</p>
            <p class="flex gap-3"><i class="fa-solid fa-check text-white"></i> Visual Context Practice</p>
            <p class="flex gap-3"><i class="fa-solid fa-check text-white"></i> Audio Practice</p>
            <p class="flex gap-3 text-slate-400 opacity-80"><i class="fa-solid fa-circle-info"></i> Designed for interview preparation and practice.</p>
          </div>
          <button id="btnPro" disabled onclick="initiatePayment('pro')" class="w-full py-4 rounded-xl bg-white/5 text-white hover:bg-white/10 border border-white/10 text-xs font-bold uppercase transition disabled:opacity-50 disabled:cursor-not-allowed">Upgrade to Pro</button>
        </div>

        <div class="physics-card pricing-elite p-6 md:p-8 text-left flex flex-col h-full bg-[#050505] shadow-[0_0_50px_rgba(0,0,0,0.8)] border border-white/5">
          <div class="absolute top-6 right-6 p-2 rounded-full bg-accent/10"><i class="fa-solid fa-crown text-accent text-xl animate-pulse-slow"></i></div>
          <h3 class="text-xs font-bold text-accent uppercase tracking-widest mb-4">Elite License</h3>
          <div class="text-4xl md:text-5xl font-bold text-white mb-6" id="priceStealth">...</div>
          <div class="space-y-4 text-xs text-white mb-8 flex-grow">
            <p class="flex gap-3"><i class="fa-solid fa-shield-halved text-accent"></i> Premium Guidance</p>
            <p class="flex gap-3"><i class="fa-solid fa-clipboard-check text-accent"></i> Deeper Practice Flows</p>
            <p class="flex gap-3"><i class="fa-solid fa-keyboard text-accent"></i> Faster Iteration</p>
            <p class="flex gap-3"><i class="fa-solid fa-headset text-accent"></i> Priority Support</p>
          </div>
          <button id="btnElite" disabled onclick="initiatePayment('pro_plus')" class="w-full py-4 rounded-xl bg-accent text-black hover:brightness-110 text-xs font-bold uppercase transition shadow-[0_0_20px_var(--accent-glow)] disabled:opacity-50 disabled:cursor-not-allowed active:scale-[0.99]">Get Elite Access</button>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section class="py-16 md:py-20 border-t border-white/5 bg-white/5">
    <div class="max-w-3xl mx-auto px-6">
      <h2 class="text-2xl font-medium text-white mb-10 text-center">Frequently Asked Questions.</h2>
      <div class="space-y-4">
        <div class="border border-white/10 rounded-xl bg-black overflow-hidden hover:border-white/20 transition" onclick="this.classList.toggle('faq-active')">
          <div class="p-5 flex justify-between items-center cursor-pointer">
            <span class="text-sm font-bold text-slate-200">What is Whis-AI for?</span>
            <i class="fa-solid fa-chevron-down text-slate-500 transition-transform duration-300"></i>
          </div>
          <div class="faq-content bg-white/5 px-5">
            <p class="text-xs text-slate-400 py-4 leading-relaxed">
              Whis-AI is built for interview preparation and practice: turning prompts into structured approaches, coding faster, and communicating clearly under pressure.
            </p>
          </div>
        </div>

        <div class="border border-white/10 rounded-xl bg-black overflow-hidden hover:border-white/20 transition" onclick="this.classList.toggle('faq-active')">
          <div class="p-5 flex justify-between items-center cursor-pointer">
            <span class="text-sm font-bold text-slate-200">Which operating systems?</span>
            <i class="fa-solid fa-chevron-down text-slate-500 transition-transform duration-300"></i>
          </div>
          <div class="faq-content bg-white/5 px-5">
            <p class="text-xs text-slate-400 py-4 leading-relaxed">We support macOS (Apple Silicon M1/M2/M3 & Intel) and Windows 10/11. Linux support is currently in beta.</p>
          </div>
        </div>

        <div class="border border-white/10 rounded-xl bg-black overflow-hidden hover:border-white/20 transition" onclick="this.classList.toggle('faq-active')">
          <div class="p-5 flex justify-between items-center cursor-pointer">
            <span class="text-sm font-bold text-slate-200">Can I try it for free?</span>
            <i class="fa-solid fa-chevron-down text-slate-500 transition-transform duration-300"></i>
          </div>
          <div class="faq-content bg-white/5 px-5">
            <p class="text-xs text-slate-400 py-4 leading-relaxed">
              Yes. The Starter plan includes <strong>3 full sessions</strong> so you can test the full experience before upgrading.
              After that, you retain 10 free syntheses per day.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="py-12 bg-black border-t border-white/5 flex flex-col items-center gap-6 pb-32 md:pb-12">
    <div class="flex flex-wrap justify-center gap-8 text-slate-500 text-xs font-medium">
      <a href="/contact" class="hover:text-white transition">Contact</a>
      <a href="/troubleshoot" class="hover:text-white transition">Troubleshooting</a>
      <a href="/terms" class="hover:text-white transition">Terms of Service</a>
      <a href="/privacy" class="hover:text-white transition">Privacy Policy</a>
      <a href="/refund-policy" class="hover:text-white transition">Refund Policy</a>
    </div>
    <div class="flex flex-col items-center gap-2">
      <span class="text-accent text-lg"><i class="fa-solid fa-bolt"></i></span>
      <p class="text-slate-600 text-[10px] uppercase tracking-widest">Built for people who refuse to freeze.</p>
    </div>
  </footer>

  <!-- LOGIN MODAL (feature preserved) -->
  <div id="loginModal" class="fixed inset-0 z-[100] hidden items-center justify-center p-4 bg-black/90 backdrop-blur-md transition-opacity duration-300" role="dialog" aria-modal="true" aria-label="Sign in">
    <div class="physics-card p-10 max-w-sm w-full text-center relative border border-white/20 shadow-2xl">
      <button onclick="closeLoginModal()" class="absolute top-4 right-4 text-slate-500 hover:text-white transition" aria-label="Close"><i class="fa-solid fa-times"></i></button>
      <div class="mb-6 w-12 h-12 rounded-full bg-white/5 border border-white/10 mx-auto flex items-center justify-center"><i class="fa-solid fa-user-astronaut text-white text-xl"></i></div>
      <h3 class="text-xl font-medium text-white mb-2">Sign In</h3>
      <p class="text-xs text-slate-400 mb-8">Access your dashboard and subscription.</p>
      <div id="googleBtnContainer" class="flex justify-center h-[50px] overflow-hidden"></div>
    </div>
  </div>

  <!-- SUCCESS MODAL -->
  <div id="successModal" class="fixed inset-0 z-[200] hidden items-center justify-center p-4 bg-black/90 backdrop-blur-md" role="dialog" aria-modal="true" aria-label="Payment success">
    <div class="physics-card p-8 max-w-sm w-full text-center border border-green-500/30 shadow-[0_0_55px_rgba(16,185,129,0.18)]">
      <div class="w-16 h-16 rounded-full bg-green-500/20 flex items-center justify-center mx-auto mb-6 border border-green-500/50">
        <i class="fa-solid fa-check text-2xl text-green-400"></i>
      </div>
      <h3 class="text-xl font-bold text-white mb-2">Upgrade Complete</h3>
      <p class="text-slate-400 text-sm mb-8">Your plan is active. Enjoy the premium experience.</p>
      <button onclick="window.location.reload()" class="w-full py-3 rounded-xl bg-green-500 text-black font-bold hover:bg-green-400 transition shadow-lg active:scale-[0.99]">Continue</button>
    </div>
  </div>

  <!-- PAYMENT MODAL -->
  <div id="paymentModal" class="fixed inset-0 z-[150] hidden items-center justify-center p-4 bg-black/90 backdrop-blur-md" role="dialog" aria-modal="true" aria-label="Payment">
    <div class="physics-card p-8 max-w-sm w-full text-center border border-white/20 relative">
      <button onclick="closePaymentModal()" class="absolute top-4 right-4 text-slate-500 hover:text-white transition" aria-label="Close"><i class="fa-solid fa-times"></i></button>

      <h3 class="text-xl font-bold text-white mb-2">Secure Gateway</h3>
      <p class="text-xs text-slate-400 mb-8">Encrypted transaction.</p>

      <button onclick="triggerRazorpayFlow(event)" class="w-full py-3.5 mb-4 rounded-xl bg-[#3395ff] text-white font-bold hover:brightness-110 transition flex items-center justify-center gap-3 shadow-lg active:scale-[0.99]">
        <i class="fa-solid fa-credit-card"></i> Card / UPI (Razorpay)
      </button>

      <div class="relative flex py-2 items-center mb-4 opacity-50">
        <div class="flex-grow border-t border-white/10"></div>
        <span class="flex-shrink mx-4 text-[10px] text-slate-500">INTERNATIONAL</span>
        <div class="flex-grow border-t border-white/10"></div>
      </div>

      <div id="paypal-button-container" class="w-full min-h-[45px]"></div>
    </div>
  </div>

  <!-- DOWNLOAD MODAL -->
  <div id="downloadModal" class="fixed inset-0 z-[100] hidden items-center justify-center p-4 bg-black/90 backdrop-blur-md" role="dialog" aria-modal="true" aria-label="Download">
    <div class="physics-card p-8 max-w-md w-full border border-white/10 relative">
      <button onclick="closeDownloadModal()" class="absolute top-4 right-4 text-slate-500 hover:text-white transition" aria-label="Close"><i class="fa-solid fa-times"></i></button>
      <h3 class="text-lg font-medium text-white mb-6">Select Architecture</h3>
      <div class="space-y-3">
        <a href="https://github.com/syedwaseemfahad/whis-releases/releases/download/v.1.4.mac/Whis-1.0.1-arm64.dmg" class="flex items-center justify-between p-4 bg-white/5 rounded-xl hover:bg-white/10 transition group border border-white/5 hover:border-white/20">
          <span class="flex items-center gap-4 text-sm text-white font-bold">
            <div class="w-8 h-8 rounded bg-white text-black flex items-center justify-center"><i class="fa-brands fa-apple text-xl"></i></div>
            macOS (Apple Silicon)
          </span>
          <i class="fa-solid fa-download text-slate-500 group-hover:text-white transition"></i>
        </a>
        <a href="https://github.com/syedwaseemfahad/whis-releases/releases/download/v.1.4.mac/Whis-1.0.1-arm64.dmg" class="flex items-center justify-between p-4 bg-white/5 rounded-xl hover:bg-white/10 transition group border border-white/5 hover:border-white/20">
          <span class="flex items-center gap-4 text-sm text-white font-bold">
            <div class="w-8 h-8 rounded bg-gray-600 text-white flex items-center justify-center"><i class="fa-brands fa-apple text-xl"></i></div>
            macOS (Intel)
          </span>
          <i class="fa-solid fa-download text-slate-500 group-hover:text-white transition"></i>
        </a>
        <a href="https://github.com/syedwaseemfahad/whis-releases/releases/download/v.1.4.windows/Whis.Setup.1.0.1.exe" class="flex items-center justify-between p-4 bg-white/5 rounded-xl hover:bg-white/10 transition group border border-white/5 hover:border-white/20">
          <span class="flex items-center gap-4 text-sm text-white font-bold">
            <div class="w-8 h-8 rounded bg-[#0078D6] text-white flex items-center justify-center"><i class="fa-brands fa-windows text-xl"></i></div>
            Windows 10 / 11
          </span>
          <i class="fa-solid fa-download text-slate-500 group-hover:text-white transition"></i>
        </a>
      </div>
      <p class="text-[10px] text-center text-slate-500 mt-6 pt-4 border-t border-white/5">Installing this activates your free sessions instantly.</p>
    </div>
  </div>

  <!-- PROFILE MODAL -->
  <div id="profileModal" class="fixed inset-0 z-[100] hidden items-center justify-center p-4 bg-black/90 backdrop-blur-md" role="dialog" aria-modal="true" aria-label="Profile">
    <div class="physics-card p-8 max-w-sm w-full text-center border border-white/10 relative">
      <button onclick="closeProfileModal()" class="absolute top-4 right-4 text-slate-500 hover:text-white transition" aria-label="Close"><i class="fa-solid fa-times"></i></button>
      <img id="modalUserAvatar" class="w-20 h-20 rounded-full mx-auto mb-4 border-2 border-accent p-1 object-cover" />
      <h3 id="modalUserName" class="text-lg font-bold text-white mb-6">User</h3>
      <div class="bg-white/5 rounded-xl p-6 text-left mb-6 border border-white/5">
        <p class="text-[10px] text-slate-500 uppercase tracking-widest mb-1">Current Plan</p>
        <div class="flex justify-between items-baseline">
          <span id="modalPlanName" class="text-xl font-bold text-white">Free</span>
          <span id="modalPlanStatus" class="text-[10px] bg-white/10 px-2 py-0.5 rounded text-white border border-white/10">ACTIVE</span>
        </div>
        <div id="modalPlanValidity" class="text-[10px] text-slate-400 mt-2 font-mono"></div>
      </div>
      <button onclick="logout()" class="w-full py-3 rounded-lg bg-red-500/10 text-red-400 hover:bg-red-500/20 text-xs font-bold uppercase transition border border-red-500/20 active:scale-[0.99]">Sign Out</button>
    </div>
  </div>

  <script>
    // --- CELEBRATION LOGIC (preserved) ---
    let celebrationInterval;
    let confettiInterval;

    function triggerCelebration() {
      const modal = document.getElementById('celebrationModal');
      modal.classList.remove('hidden');
      modal.classList.add('flex');

      const audio = new Audio('https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3');
      audio.volume = 0.5;
      audio.play().catch(e => console.log("Audio autoplay blocked"));

      fireContinuousConfetti();
      startCountdown();
    }

    function fireContinuousConfetti() {
      const duration = 10000;
      const animationEnd = Date.now() + duration;
      const defaults = { startVelocity: 28, spread: 360, ticks: 60, zIndex: 2000 };
      function random(min, max) { return Math.random() * (max - min) + min; }

      // slightly lighter cadence to reduce jank on mid devices
      confettiInterval = setInterval(function() {
        const timeLeft = animationEnd - Date.now();
        if (timeLeft <= 0) return clearInterval(confettiInterval);
        const particleCount = 40 * (timeLeft / duration);
        confetti(Object.assign({}, defaults, { particleCount, origin: { x: random(0.12, 0.32), y: Math.random() - 0.2 } }));
        confetti(Object.assign({}, defaults, { particleCount, origin: { x: random(0.68, 0.88), y: Math.random() - 0.2 } }));
      }, 300);
    }

    function startCountdown() {
      let timeLeft = 10;
      const timerEl = document.getElementById('countdownTimer');
      celebrationInterval = setInterval(() => {
        timeLeft--;
        if (timeLeft >= 0) timerEl.innerText = timeLeft;
        if (timeLeft <= 0) closeCelebration();
      }, 1000);
    }

    function closeCelebration() {
      clearInterval(celebrationInterval);
      clearInterval(confettiInterval);

      const modal = document.getElementById('celebrationModal');
      modal.classList.add('opacity-0');
      setTimeout(() => {
        modal.classList.add('hidden');
        modal.classList.remove('flex', 'opacity-0');
        openDownloadModal();
      }, 500);
    }

    // --- 1. PHYSICS (preserved) ---
    function initPhysics() {
      if(window.innerWidth < 768) return;

      const cards = document.querySelectorAll('.physics-card, .carousel-item');
      let ticking = false;

      document.addEventListener('mousemove', (e) => {
        if (ticking) return;
        window.requestAnimationFrame(() => {
          const mouseX = e.clientX;
          const mouseY = e.clientY;
          cards.forEach(card => {
            const rect = card.getBoundingClientRect();
            const x = mouseX - rect.left;
            const y = mouseY - rect.top;
            card.style.setProperty('--mouse-x', `${x}px`);
            card.style.setProperty('--mouse-y', `${y}px`);
          });
          ticking = false;
        });
        ticking = true;
      }, { passive: true });
    }

    function playIntro() {
      const t1 = document.getElementById('intro-text');
      const layer = document.getElementById('intro-layer');
      setTimeout(() => t1.classList.add('intro-active'), 120);
      setTimeout(() => { layer.style.opacity = '0'; }, 1750);
      setTimeout(() => { layer.style.display = 'none'; }, 2550);
    }

    // Nav scroll polish
    function initNavScroll() {
      const nav = document.getElementById('topNav');
      const onScroll = () => {
        if (window.scrollY > 8) nav.classList.add('nav-scrolled');
        else nav.classList.remove('nav-scrolled');
      };
      window.addEventListener('scroll', onScroll, { passive: true });
      onScroll();
    }

    // --- 2. CAROUSEL ENGINE (preserved) ---
    const videos = [
      { src: 'visual.mp4', label: 'VISUAL CONTEXT ANALYSIS' },
      { src: 'text.mp4', label: 'REAL-TIME CODE SYNTHESIS' },
      { src: 'audio.mp4', label: 'AUDIO STREAM INGESTION' }
    ];
    let activeIndex = 0;

    function initCarousel() {
      const container = document.getElementById('carouselContainer');
      container.innerHTML = '';
      videos.forEach((v, i) => {
        const div = document.createElement('div');
        div.className = 'carousel-item physics-card';
        div.id = `c-item-${i}`;

        const wrapper = document.createElement('div');
        wrapper.className = "relative w-full h-full";

        const video = document.createElement('video');
        video.src = v.src;
        video.muted = true;
        video.playsInline = true;
        video.preload = "metadata";
        video.style.cssText = "width:100%; height:100%; object-fit:contain; background:#000;";

        const labelOverlay = document.createElement('div');
        labelOverlay.className = "video-label-overlay";
        labelOverlay.innerHTML = `<h3 class="text-white text-lg font-bold">${v.label}</h3><p class="text-[10px] text-accent uppercase tracking-widest mt-1">Live Processing</p>`;

        wrapper.appendChild(video);
        wrapper.appendChild(labelOverlay);
        div.appendChild(wrapper);

        let touchTimer;

        const startTouch = () => {
          if(window.innerWidth > 768) return;
          if(div.classList.contains('item-center')){
            touchTimer = setTimeout(() => {
              video.classList.add('cinematic-fullscreen');
              video.muted = false;
              video.controls = true;
              video.play().catch(()=>{});
            }, 650); // faster + feels more premium
          }
        };

        const endTouch = () => {
          clearTimeout(touchTimer);
          if(video.classList.contains('cinematic-fullscreen')){
            video.classList.remove('cinematic-fullscreen');
            video.muted = true;
            video.controls = false;
          }
        };

        div.addEventListener('touchstart', startTouch, {passive: true});
        div.addEventListener('touchend', endTouch);
        div.addEventListener('touchcancel', endTouch);

        container.appendChild(div);
      });
      updateCarousel();
    }

    function updateCarousel() {
      const total = videos.length;
      const prev = (activeIndex - 1 + total) % total;
      const next = (activeIndex + 1) % total;

      videos.forEach((_, i) => {
        const el = document.getElementById(`c-item-${i}`);
        const vid = el.querySelector('video');

        el.className = 'carousel-item physics-card transition-all duration-700 ease-[cubic-bezier(0.25,1,0.5,1)]';
        vid.classList.remove('cinematic-fullscreen');
        vid.controls = false;
        vid.onended = null;

        if(i === activeIndex) {
          el.classList.add('item-center');
          vid.currentTime = 0;
          vid.play().catch(() => { setTimeout(() => nextSlide(), 5000); });
          vid.style.opacity = '1';
          vid.onended = () => { nextSlide(); };
        } else if (i === prev) {
          el.classList.add('item-left');
          vid.pause(); vid.style.opacity = '0.3';
        } else if (i === next) {
          el.classList.add('item-right');
          vid.pause(); vid.style.opacity = '0.3';
        } else {
          el.classList.add('item-hidden');
          vid.pause();
        }
      });

      const label = document.getElementById('featureLabel');
      label.style.opacity = '0';
      setTimeout(() => {
        label.innerText = videos[activeIndex].label;
        label.style.opacity = '1';
      }, 280);
    }

    function nextSlide() {
      activeIndex = (activeIndex + 1) % videos.length;
      updateCarousel();
    }

    // --- 3. IDE TYPEWRITER EFFECT (preserved) ---
    const codeLines = [
      { text: "class ", class: "keyword" }, { text: "Solution", class: "function" }, { text: ":\n", class: "" },
      { text: "    def ", class: "keyword" }, { text: "trap", class: "function" }, { text: "(self, height: List[int]) -> int:\n", class: "" },
      { text: "        if not ", class: "keyword" }, { text: "height: ", class: "" }, { text: "return ", class: "keyword" }, { text: "0\n", class: "number" },
      { text: "        l, r = ", class: "" }, { text: "0", class: "number" }, { text: ", len(height) - ", class: "" }, { text: "1\n", class: "number" },
      { text: "        leftMax, rightMax = height[l], height[r]\n", class: "" },
      { text: "        res = ", class: "" }, { text: "0\n", class: "number" },
      { text: "        while ", class: "keyword" }, { text: "l < r:\n", class: "" },
      { text: "            if ", class: "keyword" }, { text: "leftMax < rightMax:\n", class: "" },
      { text: "                l += ", class: "" }, { text: "1\n", class: "number" },
      { text: "                leftMax = max(leftMax, height[l])\n", class: "" },
      { text: "                res += leftMax - height[l]\n", class: "" },
      { text: "            else", class: "keyword" }, { text: ":\n", class: "" },
      { text: "                r -= ", class: "" }, { text: "1\n", class: "number" },
      { text: "                rightMax = max(rightMax, height[r])\n", class: "" },
      { text: "                res += rightMax - height[r]\n", class: "" },
      { text: "        return ", class: "keyword" }, { text: "res", class: "" }
    ];
    let currentPart = 0; let currentChar = 0;

    function typeCode() {
      const el = document.getElementById('code-display');
      if(!el) return;

      if (currentPart < codeLines.length) {
        const part = codeLines[currentPart];
        let span = el.lastElementChild;
        if (currentChar === 0 || !span) {
          span = document.createElement('span');
          if (part.class) span.className = part.class;
          el.appendChild(span);
        }
        span.textContent += part.text[currentChar];
        currentChar++;
        if (currentChar >= part.text.length) { currentPart++; currentChar = 0; }
        setTimeout(typeCode, 15);
      } else {
        setTimeout(() => { el.innerHTML = ''; currentPart = 0; currentChar = 0; typeCode(); }, 4000);
      }
    }

    // --- 4. DYNAMIC SIGNUPS LOGIC (preserved) ---
    function updateDynamicSignups() {
      const now = new Date();
      const istOffset = 5.5 * 60 * 60 * 1000;
      const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
      const istDate = new Date(utc + istOffset);
      let hour = istDate.getHours();
      let count = hour * hour + 942;
      if(count === 0) count = 45;

      const badge = document.getElementById('signup-badge-text');
      if(badge) badge.innerText = `ðŸ”¥ ${count} candidates practicing now`;
    }

    // --- 5. BACKEND CONNECTION & AUTH (preserved) ---
    const BACKEND_URL="https://whis-backend.onrender.com";
    let currentUser = null, currentCycle = 'monthly', currentTier = 'free';
    let PRICING_CONFIG = null;
    let GOOGLE_CLIENT_ID = null;

    function detectOS(){
      const p = navigator.platform.toLowerCase();
      const ua = navigator.userAgent.toLowerCase();
      const isWin = p.includes('win') || ua.includes('windows');
      const isMac = (p.includes('mac') || ua.includes('macintosh')) && !ua.includes('iphone');
      // preserved: no text replacement
    }

    async function fetchPricingConfig() {
      try {
        const res = await fetch(`${BACKEND_URL}/api/config`);
        if(res.ok) {
          const data = await res.json();
          PRICING_CONFIG = data.pricing;
          GOOGLE_CLIENT_ID = data.googleClientId;
          updatePricingUI();
          document.getElementById('btnPro').disabled = false;
          document.getElementById('btnElite').disabled = false;
        }
      } catch(e) { console.error("Config Error", e); }
    }

    function checkUser(){
      const s=localStorage.getItem('whisUser');
      if(s){
        try{
          currentUser=JSON.parse(s);
          updateNavUI(currentUser);
          fetchUserStatus();
        }catch(e){localStorage.removeItem('whisUser');}
      }
    }

    function updateNavUI(u){
      document.getElementById('signInBtn').style.display='none';
      const profileTrigger = document.getElementById('userProfileTrigger');
      profileTrigger.classList.remove('hidden');
      profileTrigger.classList.add('flex');
      document.getElementById('navUserAvatar').src = u.avatarUrl;
    }

    async function handleGoogleRes(res){
      try {
        const r=await fetch(`${BACKEND_URL}/api/auth/google`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:res.credential})});
        const d=await r.json();
        if(d.success){
          localStorage.setItem('whisUser',JSON.stringify(d.user));
          currentUser=d.user;
          updateNavUI(currentUser);
          fetchUserStatus();
          closeLoginModal();
        }
      } catch(e){ console.error(e); }
    }

    function formatPrice(amount, discount) {
      if (!amount) return "...";
      if(discount > 0) {
        const discounted = Math.floor(amount * (1 - discount/100));
        return `<span>â‚¹${discounted}</span> <span class="text-sm line-through text-slate-500 opacity-60 mx-1">â‚¹${Math.floor(amount)}</span> <span class="text-[10px] font-bold text-black bg-accent px-1.5 py-0.5 rounded align-middle">-${discount}%</span>`;
      }
      return `â‚¹${Math.floor(amount)}`;
    }

    function setCycle(c){
      currentCycle=c;
      const btnM=document.getElementById('btnMonthly');
      const btnA=document.getElementById('btnAnnual');

      const activeClass = "px-8 py-2.5 rounded-lg text-xs font-bold bg-white text-black transition shadow-lg transform scale-105";
      const inactiveClass = "px-8 py-2.5 rounded-lg text-xs font-bold text-slate-500 hover:text-white transition";

      if(c==='monthly'){ btnM.className = activeClass; btnA.className = inactiveClass; }
      else { btnA.className = activeClass; btnM.className = inactiveClass; }
      updatePricingUI();
    }

    function updatePricingUI() {
      if (!PRICING_CONFIG) return;
      const proDiv = document.getElementById('pricePro');
      const eliteDiv = document.getElementById('priceStealth');

      let proPrice = 0, elitePrice = 0;
      let proDisc = PRICING_CONFIG.pro.discount;
      let eliteDisc = PRICING_CONFIG.pro_plus.discount;

      if (currentCycle === 'monthly') {
        proPrice = PRICING_CONFIG.pro.monthly;
        elitePrice = PRICING_CONFIG.pro_plus.monthly;
        proDiv.innerHTML = `${formatPrice(proPrice, proDisc)}<span class="text-[12px] text-slate-500 block font-normal mt-1">/month</span>`;
        eliteDiv.innerHTML = `${formatPrice(elitePrice, eliteDisc)}<span class="text-[12px] text-slate-500 block font-normal mt-1">/month</span>`;
      } else {
        proPrice = PRICING_CONFIG.pro.annual_per_month;
        elitePrice = PRICING_CONFIG.pro_plus.annual_per_month;
        proDiv.innerHTML = `${formatPrice(proPrice, proDisc)}<span class="text-[12px] text-slate-500 block font-normal mt-1">/mo (billed yearly)</span>`;
        eliteDiv.innerHTML = `${formatPrice(elitePrice, eliteDisc)}<span class="text-[12px] text-slate-500 block font-normal mt-1">/mo (billed yearly)</span>`;
      }
    }

    async function fetchUserStatus() {
      if(!currentUser) return;
      try {
        const r = await fetch(`${BACKEND_URL}/api/user/status`, {headers:{'x-google-id':currentUser.googleId}});
        const d = await r.json();
        if(d.active) currentTier = d.tier; else currentTier = 'free';

        const badge = document.getElementById('navPlanBadge');
        const validityEl = document.getElementById('modalPlanValidity');

        if(d.active){
          badge.innerText = d.tier === 'pro_plus' ? 'ELITE' : 'PRO';
          badge.className = "text-[9px] font-bold text-accent uppercase tracking-wide";

          document.getElementById('modalPlanName').innerText = d.tier === 'pro_plus' ? 'Elite License' : 'Pro License';
          document.getElementById('modalPlanStatus').innerText = 'ACTIVE';

          if(d.expiry || d.validUntil) {
            const dateStr = new Date(d.expiry || d.validUntil).toLocaleDateString();
            validityEl.innerText = "Renews: " + dateStr;
          }

          const btnPro = document.getElementById('btnPro');
          const btnElite = document.getElementById('btnElite');
          if(d.tier === 'pro') { btnPro.innerText="Current Plan"; btnPro.disabled=true; btnElite.innerText="Upgrade to Elite"; }
          if(d.tier === 'pro_plus') { btnPro.innerText="Included"; btnPro.disabled=true; btnElite.innerText="Current Plan"; btnElite.disabled=true; }
        } else {
          badge.innerText = 'FREE';
          badge.className = "text-[9px] font-bold text-slate-400 uppercase tracking-wide";
        }
        document.getElementById('modalUserName').innerText = currentUser.name;
        document.getElementById('modalUserAvatar').src = currentUser.avatarUrl;
      } catch(e){}
    }

    // --- 6. PAYMENT SYSTEM (preserved) ---
    let selectedTierForPayment = null;
    const paymentModal = document.getElementById('paymentModal');

    function initiatePayment(targetTier) {
      if(!currentUser){ openLoginModal(); return; }
      if(currentTier === 'pro_plus') return;
      if(currentTier === 'pro' && targetTier === 'pro') return;
      selectedTierForPayment = targetTier;
      openPaymentModal();
    }

    function openPaymentModal() {
      paymentModal.classList.remove('hidden');
      paymentModal.classList.add('flex');
      document.getElementById('paypal-button-container').innerHTML = '';

      paypal.Buttons({
        style: { layout: 'vertical', color: 'gold', shape: 'rect', label: 'pay' },
        createOrder: async function(data, actions) {
          const res = await fetch(`${BACKEND_URL}/api/payment/create-paypal-order`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ googleId: currentUser.googleId, tier: selectedTierForPayment, cycle: currentCycle })
          });
          const orderData = await res.json();
          return orderData.id;
        },
        onApprove: async function(data, actions) {
          const res = await fetch(`${BACKEND_URL}/api/payment/verify-paypal`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ orderID: data.orderID, googleId: currentUser.googleId })
          });
          const details = await res.json();
          if (details.success) {
            closePaymentModal();
            document.getElementById('successModal').classList.remove('hidden');
            document.getElementById('successModal').classList.add('flex');
          } else {
            alert("PayPal Verification Failed.");
          }
        },
        onError: function (err) { alert("PayPal Error. Please try Razorpay."); }
      }).render('#paypal-button-container');
    }

    function closePaymentModal() {
      paymentModal.classList.add('hidden');
      paymentModal.classList.remove('flex');
    }

    async function triggerRazorpayFlow(event) {
      const targetTier = selectedTierForPayment;
      const isUpgrade = (currentTier === 'pro' && targetTier === 'pro_plus');
      const btn = event.currentTarget;
      const orig = btn.innerHTML;
      btn.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i> Processing...';

      try {
        const res = await fetch(`${BACKEND_URL}/api/payment/create-order`,{
          method:'POST', headers:{'Content-Type':'application/json'},
          body:JSON.stringify({ googleId: currentUser.googleId, tier: targetTier, cycle: currentCycle, isUpgrade: isUpgrade })
        });
        const data = await res.json();

        if(data.order_id){
          const rzp1 = new Razorpay({
            "key": data.key_id,
            "amount": data.amount,
            "currency": data.currency,
            "name": "Whis AI",
            "description": isUpgrade ? "Upgrade License" : "New License",
            "order_id": data.order_id,
            "handler": async function (response){
              try {
                const verifyRes = await fetch(`${BACKEND_URL}/api/payment/verify`, {
                  method: 'POST', headers: {'Content-Type': 'application/json'},
                  body: JSON.stringify({
                    razorpay_order_id: response.razorpay_order_id,
                    razorpay_payment_id: response.razorpay_payment_id,
                    razorpay_signature: response.razorpay_signature
                  })
                });
                const verifyData = await verifyRes.json();
                if(verifyData.success){
                  closePaymentModal();
                  document.getElementById('successModal').classList.remove('hidden');
                  document.getElementById('successModal').classList.add('flex');
                } else {
                  alert("Verification Failed.");
                }
              } catch(e) { alert("Network Error"); }
            },
            "theme": { "color": "#00f2ff" },
            "modal": { "ondismiss": function(){ btn.innerHTML = orig; } }
          });
          rzp1.open();
        }
      } catch(e){
        console.error(e);
        btn.innerHTML = orig;
      }
    }

    function logout(){ localStorage.removeItem('whisUser'); location.reload(); }

    // --- 7. MODAL HELPERS (preserved) ---
    const loginModal=document.getElementById('loginModal');
    const downloadModal=document.getElementById('downloadModal');
    const profileModal=document.getElementById('profileModal');

    function openLoginModal(){
      loginModal.classList.remove('hidden'); loginModal.classList.add('flex');
      if(window.google && GOOGLE_CLIENT_ID){
        google.accounts.id.initialize({client_id:GOOGLE_CLIENT_ID,callback:handleGoogleRes});
        google.accounts.id.renderButton(document.getElementById("googleBtnContainer"),{theme:"filled_black",size:"large",shape:"pill", width: "250"});
      }
    }
    function closeLoginModal(){loginModal.classList.add('hidden');loginModal.classList.remove('flex');}
    function openDownloadModal(){downloadModal.classList.remove('hidden');downloadModal.classList.add('flex');}
    function closeDownloadModal(){downloadModal.classList.add('hidden');downloadModal.classList.remove('flex');}
    function openProfileModal(){if(currentUser)fetchUserStatus();profileModal.classList.remove('hidden');profileModal.classList.add('flex');}
    function closeProfileModal(){profileModal.classList.add('hidden');profileModal.classList.remove('flex');}

    // --- INIT ---
    document.addEventListener("DOMContentLoaded", () => {
      playIntro();
      initNavScroll();
      initCarousel();
      typeCode();
      checkUser();
      detectOS();
      fetchPricingConfig();
      updateDynamicSignups();
      setTimeout(initPhysics, 500);

      setTimeout(triggerCelebration, 6000);
    });
  </script>
</body>
</html>
